2024-06-22 15:32:45,539 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'gccf', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-06, 'amazon': {'layer_num': 2, 'reg_weight': 1e-06}, 'yelp': {'layer_num': 2, 'reg_weight': 1e-06}, 'steam': {'layer_num': 2, 'reg_weight': 1e-06}}}
2024-06-22 15:32:49,301 - Epoch   0 Validation set [recall@5: 0.0088 recall@10: 0.0152 recall@20: 0.0255 ] [ndcg@5: 0.0092 ndcg@10: 0.0113 ndcg@20: 0.0146 ] 
2024-06-22 15:32:52,361 - Epoch   3 Validation set [recall@5: 0.0186 recall@10: 0.0323 recall@20: 0.0528 ] [ndcg@5: 0.0192 ndcg@10: 0.0241 ndcg@20: 0.0308 ] 
2024-06-22 15:32:55,324 - Epoch   6 Validation set [recall@5: 0.0210 recall@10: 0.0355 recall@20: 0.0576 ] [ndcg@5: 0.0216 ndcg@10: 0.0267 ndcg@20: 0.0338 ] 
2024-06-22 15:32:58,187 - Epoch   9 Validation set [recall@5: 0.0248 recall@10: 0.0407 recall@20: 0.0650 ] [ndcg@5: 0.0250 ndcg@10: 0.0306 ndcg@20: 0.0384 ] 
2024-06-22 15:33:01,027 - Epoch  12 Validation set [recall@5: 0.0272 recall@10: 0.0448 recall@20: 0.0711 ] [ndcg@5: 0.0277 ndcg@10: 0.0337 ndcg@20: 0.0423 ] 
2024-06-22 15:33:03,934 - Epoch  15 Validation set [recall@5: 0.0301 recall@10: 0.0486 recall@20: 0.0783 ] [ndcg@5: 0.0310 ndcg@10: 0.0370 ndcg@20: 0.0466 ] 
2024-06-22 15:33:06,869 - Epoch  18 Validation set [recall@5: 0.0318 recall@10: 0.0519 recall@20: 0.0822 ] [ndcg@5: 0.0326 ndcg@10: 0.0394 ndcg@20: 0.0493 ] 
2024-06-22 15:33:09,753 - Epoch  21 Validation set [recall@5: 0.0331 recall@10: 0.0534 recall@20: 0.0866 ] [ndcg@5: 0.0336 ndcg@10: 0.0406 ndcg@20: 0.0513 ] 
2024-06-22 15:33:12,921 - Epoch  24 Validation set [recall@5: 0.0341 recall@10: 0.0570 recall@20: 0.0903 ] [ndcg@5: 0.0349 ndcg@10: 0.0429 ndcg@20: 0.0536 ] 
2024-06-22 15:33:15,821 - Epoch  27 Validation set [recall@5: 0.0345 recall@10: 0.0583 recall@20: 0.0933 ] [ndcg@5: 0.0359 ndcg@10: 0.0441 ndcg@20: 0.0553 ] 
2024-06-22 15:33:18,856 - Epoch  30 Validation set [recall@5: 0.0364 recall@10: 0.0601 recall@20: 0.0960 ] [ndcg@5: 0.0369 ndcg@10: 0.0450 ndcg@20: 0.0566 ] 
2024-06-22 15:33:21,901 - Epoch  33 Validation set [recall@5: 0.0373 recall@10: 0.0618 recall@20: 0.0975 ] [ndcg@5: 0.0377 ndcg@10: 0.0462 ndcg@20: 0.0577 ] 
2024-06-22 15:33:25,905 - Epoch  36 Validation set [recall@5: 0.0385 recall@10: 0.0633 recall@20: 0.0995 ] [ndcg@5: 0.0387 ndcg@10: 0.0474 ndcg@20: 0.0591 ] 
2024-06-22 15:33:30,765 - Epoch  39 Validation set [recall@5: 0.0399 recall@10: 0.0639 recall@20: 0.1018 ] [ndcg@5: 0.0399 ndcg@10: 0.0482 ndcg@20: 0.0604 ] 
2024-06-22 15:33:35,564 - Epoch  42 Validation set [recall@5: 0.0405 recall@10: 0.0653 recall@20: 0.1035 ] [ndcg@5: 0.0405 ndcg@10: 0.0491 ndcg@20: 0.0615 ] 
2024-06-22 15:33:39,677 - Epoch  45 Validation set [recall@5: 0.0408 recall@10: 0.0663 recall@20: 0.1054 ] [ndcg@5: 0.0412 ndcg@10: 0.0500 ndcg@20: 0.0627 ] 
2024-06-22 15:33:43,171 - Epoch  48 Validation set [recall@5: 0.0413 recall@10: 0.0676 recall@20: 0.1064 ] [ndcg@5: 0.0417 ndcg@10: 0.0508 ndcg@20: 0.0634 ] 
2024-06-22 15:33:46,537 - Epoch  51 Validation set [recall@5: 0.0425 recall@10: 0.0690 recall@20: 0.1080 ] [ndcg@5: 0.0425 ndcg@10: 0.0517 ndcg@20: 0.0643 ] 
2024-06-22 15:33:49,818 - Epoch  54 Validation set [recall@5: 0.0434 recall@10: 0.0694 recall@20: 0.1082 ] [ndcg@5: 0.0431 ndcg@10: 0.0521 ndcg@20: 0.0648 ] 
2024-06-22 15:33:52,983 - Epoch  57 Validation set [recall@5: 0.0437 recall@10: 0.0692 recall@20: 0.1099 ] [ndcg@5: 0.0437 ndcg@10: 0.0525 ndcg@20: 0.0657 ] 
2024-06-22 15:33:56,264 - Epoch  60 Validation set [recall@5: 0.0445 recall@10: 0.0706 recall@20: 0.1115 ] [ndcg@5: 0.0443 ndcg@10: 0.0532 ndcg@20: 0.0665 ] 
2024-06-22 15:34:00,937 - Epoch  63 Validation set [recall@5: 0.0449 recall@10: 0.0714 recall@20: 0.1123 ] [ndcg@5: 0.0449 ndcg@10: 0.0539 ndcg@20: 0.0670 ] 
2024-06-22 15:34:04,703 - Epoch  66 Validation set [recall@5: 0.0447 recall@10: 0.0719 recall@20: 0.1134 ] [ndcg@5: 0.0450 ndcg@10: 0.0543 ndcg@20: 0.0677 ] 
2024-06-22 15:34:07,970 - Epoch  69 Validation set [recall@5: 0.0458 recall@10: 0.0730 recall@20: 0.1150 ] [ndcg@5: 0.0456 ndcg@10: 0.0548 ndcg@20: 0.0683 ] 
2024-06-22 15:34:11,115 - Epoch  72 Validation set [recall@5: 0.0462 recall@10: 0.0734 recall@20: 0.1160 ] [ndcg@5: 0.0457 ndcg@10: 0.0553 ndcg@20: 0.0689 ] 
2024-06-22 15:34:15,016 - Epoch  75 Validation set [recall@5: 0.0466 recall@10: 0.0738 recall@20: 0.1165 ] [ndcg@5: 0.0462 ndcg@10: 0.0557 ndcg@20: 0.0693 ] 
2024-06-22 15:34:18,479 - Epoch  78 Validation set [recall@5: 0.0471 recall@10: 0.0750 recall@20: 0.1180 ] [ndcg@5: 0.0468 ndcg@10: 0.0565 ndcg@20: 0.0703 ] 
2024-06-22 15:34:21,576 - Epoch  81 Validation set [recall@5: 0.0471 recall@10: 0.0756 recall@20: 0.1175 ] [ndcg@5: 0.0469 ndcg@10: 0.0568 ndcg@20: 0.0704 ] 
2024-06-22 15:34:25,456 - Epoch  84 Validation set [recall@5: 0.0475 recall@10: 0.0758 recall@20: 0.1183 ] [ndcg@5: 0.0473 ndcg@10: 0.0571 ndcg@20: 0.0708 ] 
2024-06-22 15:34:29,353 - Epoch  87 Validation set [recall@5: 0.0482 recall@10: 0.0757 recall@20: 0.1193 ] [ndcg@5: 0.0478 ndcg@10: 0.0572 ndcg@20: 0.0712 ] 
2024-06-22 15:34:33,341 - Epoch  90 Validation set [recall@5: 0.0480 recall@10: 0.0770 recall@20: 0.1200 ] [ndcg@5: 0.0480 ndcg@10: 0.0580 ndcg@20: 0.0719 ] 
2024-06-22 15:34:36,894 - Epoch  93 Validation set [recall@5: 0.0488 recall@10: 0.0776 recall@20: 0.1214 ] [ndcg@5: 0.0485 ndcg@10: 0.0583 ndcg@20: 0.0726 ] 
2024-06-22 15:34:40,030 - Epoch  96 Validation set [recall@5: 0.0491 recall@10: 0.0781 recall@20: 0.1211 ] [ndcg@5: 0.0488 ndcg@10: 0.0587 ndcg@20: 0.0727 ] 
2024-06-22 15:34:43,964 - Epoch  99 Validation set [recall@5: 0.0496 recall@10: 0.0788 recall@20: 0.1220 ] [ndcg@5: 0.0496 ndcg@10: 0.0596 ndcg@20: 0.0736 ] 
2024-06-22 15:34:47,794 - Epoch 102 Validation set [recall@5: 0.0503 recall@10: 0.0788 recall@20: 0.1228 ] [ndcg@5: 0.0497 ndcg@10: 0.0594 ndcg@20: 0.0736 ] 
2024-06-22 15:34:52,477 - Epoch 105 Validation set [recall@5: 0.0504 recall@10: 0.0794 recall@20: 0.1232 ] [ndcg@5: 0.0502 ndcg@10: 0.0599 ndcg@20: 0.0741 ] 
2024-06-22 15:34:56,118 - Epoch 108 Validation set [recall@5: 0.0506 recall@10: 0.0798 recall@20: 0.1234 ] [ndcg@5: 0.0506 ndcg@10: 0.0604 ndcg@20: 0.0746 ] 
2024-06-22 15:34:59,123 - Epoch 111 Validation set [recall@5: 0.0511 recall@10: 0.0797 recall@20: 0.1239 ] [ndcg@5: 0.0507 ndcg@10: 0.0604 ndcg@20: 0.0747 ] 
2024-06-22 15:35:02,063 - Epoch 114 Validation set [recall@5: 0.0522 recall@10: 0.0794 recall@20: 0.1245 ] [ndcg@5: 0.0517 ndcg@10: 0.0607 ndcg@20: 0.0754 ] 
2024-06-22 15:35:05,091 - Epoch 117 Validation set [recall@5: 0.0529 recall@10: 0.0797 recall@20: 0.1254 ] [ndcg@5: 0.0519 ndcg@10: 0.0609 ndcg@20: 0.0757 ] 
2024-06-22 15:35:08,319 - Epoch 120 Validation set [recall@5: 0.0529 recall@10: 0.0813 recall@20: 0.1261 ] [ndcg@5: 0.0520 ndcg@10: 0.0616 ndcg@20: 0.0762 ] 
2024-06-22 15:35:12,736 - Epoch 123 Validation set [recall@5: 0.0524 recall@10: 0.0820 recall@20: 0.1270 ] [ndcg@5: 0.0519 ndcg@10: 0.0619 ndcg@20: 0.0765 ] 
2024-06-22 15:35:16,213 - Epoch 126 Validation set [recall@5: 0.0529 recall@10: 0.0827 recall@20: 0.1263 ] [ndcg@5: 0.0520 ndcg@10: 0.0621 ndcg@20: 0.0763 ] 
2024-06-22 15:35:19,083 - Epoch 129 Validation set [recall@5: 0.0531 recall@10: 0.0829 recall@20: 0.1271 ] [ndcg@5: 0.0524 ndcg@10: 0.0625 ndcg@20: 0.0769 ] 
2024-06-22 15:35:22,097 - Epoch 132 Validation set [recall@5: 0.0532 recall@10: 0.0825 recall@20: 0.1265 ] [ndcg@5: 0.0527 ndcg@10: 0.0625 ndcg@20: 0.0768 ] 
2024-06-22 15:35:25,270 - Epoch 135 Validation set [recall@5: 0.0531 recall@10: 0.0829 recall@20: 0.1271 ] [ndcg@5: 0.0530 ndcg@10: 0.0631 ndcg@20: 0.0774 ] 
2024-06-22 15:35:28,531 - Epoch 138 Validation set [recall@5: 0.0531 recall@10: 0.0830 recall@20: 0.1270 ] [ndcg@5: 0.0529 ndcg@10: 0.0630 ndcg@20: 0.0774 ] 
2024-06-22 15:35:31,437 - Epoch 141 Validation set [recall@5: 0.0532 recall@10: 0.0839 recall@20: 0.1281 ] [ndcg@5: 0.0531 ndcg@10: 0.0635 ndcg@20: 0.0779 ] 
2024-06-22 15:35:35,121 - Epoch 144 Validation set [recall@5: 0.0525 recall@10: 0.0844 recall@20: 0.1286 ] [ndcg@5: 0.0527 ndcg@10: 0.0637 ndcg@20: 0.0781 ] 
2024-06-22 15:35:39,379 - Epoch 147 Validation set [recall@5: 0.0524 recall@10: 0.0851 recall@20: 0.1292 ] [ndcg@5: 0.0526 ndcg@10: 0.0639 ndcg@20: 0.0782 ] 
2024-06-22 15:35:43,096 - Epoch 150 Validation set [recall@5: 0.0531 recall@10: 0.0845 recall@20: 0.1298 ] [ndcg@5: 0.0532 ndcg@10: 0.0640 ndcg@20: 0.0787 ] 
2024-06-22 15:35:46,074 - Epoch 153 Validation set [recall@5: 0.0529 recall@10: 0.0849 recall@20: 0.1311 ] [ndcg@5: 0.0532 ndcg@10: 0.0642 ndcg@20: 0.0792 ] 
2024-06-22 15:35:49,130 - Epoch 156 Validation set [recall@5: 0.0534 recall@10: 0.0854 recall@20: 0.1312 ] [ndcg@5: 0.0535 ndcg@10: 0.0645 ndcg@20: 0.0793 ] 
2024-06-22 15:35:52,178 - Epoch 159 Validation set [recall@5: 0.0535 recall@10: 0.0851 recall@20: 0.1311 ] [ndcg@5: 0.0536 ndcg@10: 0.0645 ndcg@20: 0.0794 ] 
2024-06-22 15:35:55,398 - Epoch 162 Validation set [recall@5: 0.0533 recall@10: 0.0858 recall@20: 0.1316 ] [ndcg@5: 0.0536 ndcg@10: 0.0646 ndcg@20: 0.0795 ] 
2024-06-22 15:35:59,928 - Epoch 165 Validation set [recall@5: 0.0538 recall@10: 0.0865 recall@20: 0.1324 ] [ndcg@5: 0.0535 ndcg@10: 0.0648 ndcg@20: 0.0796 ] 
2024-06-22 15:36:03,049 - Epoch 168 Validation set [recall@5: 0.0541 recall@10: 0.0864 recall@20: 0.1325 ] [ndcg@5: 0.0539 ndcg@10: 0.0650 ndcg@20: 0.0799 ] 
2024-06-22 15:36:06,182 - Epoch 171 Validation set [recall@5: 0.0546 recall@10: 0.0866 recall@20: 0.1331 ] [ndcg@5: 0.0544 ndcg@10: 0.0653 ndcg@20: 0.0804 ] 
2024-06-22 15:36:09,471 - Epoch 174 Validation set [recall@5: 0.0540 recall@10: 0.0862 recall@20: 0.1327 ] [ndcg@5: 0.0540 ndcg@10: 0.0649 ndcg@20: 0.0801 ] 
2024-06-22 15:36:13,311 - Epoch 177 Validation set [recall@5: 0.0545 recall@10: 0.0866 recall@20: 0.1337 ] [ndcg@5: 0.0542 ndcg@10: 0.0651 ndcg@20: 0.0804 ] 
2024-06-22 15:36:16,508 - Epoch 180 Validation set [recall@5: 0.0553 recall@10: 0.0866 recall@20: 0.1343 ] [ndcg@5: 0.0550 ndcg@10: 0.0656 ndcg@20: 0.0810 ] 
2024-06-22 15:36:19,652 - Epoch 183 Validation set [recall@5: 0.0555 recall@10: 0.0860 recall@20: 0.1341 ] [ndcg@5: 0.0552 ndcg@10: 0.0656 ndcg@20: 0.0811 ] 
2024-06-22 15:36:22,837 - Epoch 186 Validation set [recall@5: 0.0549 recall@10: 0.0864 recall@20: 0.1339 ] [ndcg@5: 0.0549 ndcg@10: 0.0657 ndcg@20: 0.0811 ] 
2024-06-22 15:36:25,943 - Epoch 189 Validation set [recall@5: 0.0544 recall@10: 0.0867 recall@20: 0.1347 ] [ndcg@5: 0.0546 ndcg@10: 0.0659 ndcg@20: 0.0814 ] 
2024-06-22 15:36:29,428 - Epoch 192 Validation set [recall@5: 0.0554 recall@10: 0.0870 recall@20: 0.1347 ] [ndcg@5: 0.0551 ndcg@10: 0.0661 ndcg@20: 0.0815 ] 
2024-06-22 15:36:32,915 - Epoch 195 Validation set [recall@5: 0.0552 recall@10: 0.0872 recall@20: 0.1347 ] [ndcg@5: 0.0552 ndcg@10: 0.0662 ndcg@20: 0.0816 ] 
2024-06-22 15:36:36,948 - Epoch 198 Validation set [recall@5: 0.0557 recall@10: 0.0875 recall@20: 0.1344 ] [ndcg@5: 0.0554 ndcg@10: 0.0663 ndcg@20: 0.0815 ] 
2024-06-22 15:36:41,126 - Epoch 201 Validation set [recall@5: 0.0565 recall@10: 0.0877 recall@20: 0.1351 ] [ndcg@5: 0.0556 ndcg@10: 0.0664 ndcg@20: 0.0818 ] 
2024-06-22 15:36:45,129 - Epoch 204 Validation set [recall@5: 0.0561 recall@10: 0.0883 recall@20: 0.1351 ] [ndcg@5: 0.0557 ndcg@10: 0.0667 ndcg@20: 0.0819 ] 
2024-06-22 15:36:48,182 - Epoch 207 Validation set [recall@5: 0.0564 recall@10: 0.0886 recall@20: 0.1351 ] [ndcg@5: 0.0558 ndcg@10: 0.0668 ndcg@20: 0.0819 ] 
2024-06-22 15:36:51,764 - Epoch 210 Validation set [recall@5: 0.0553 recall@10: 0.0885 recall@20: 0.1353 ] [ndcg@5: 0.0550 ndcg@10: 0.0666 ndcg@20: 0.0819 ] 
2024-06-22 15:36:54,879 - Epoch 213 Validation set [recall@5: 0.0562 recall@10: 0.0885 recall@20: 0.1364 ] [ndcg@5: 0.0555 ndcg@10: 0.0668 ndcg@20: 0.0824 ] 
2024-06-22 15:36:58,459 - Epoch 216 Validation set [recall@5: 0.0558 recall@10: 0.0889 recall@20: 0.1358 ] [ndcg@5: 0.0552 ndcg@10: 0.0667 ndcg@20: 0.0820 ] 
2024-06-22 15:37:02,012 - Epoch 219 Validation set [recall@5: 0.0556 recall@10: 0.0885 recall@20: 0.1359 ] [ndcg@5: 0.0552 ndcg@10: 0.0667 ndcg@20: 0.0821 ] 
2024-06-22 15:37:05,745 - Epoch 222 Validation set [recall@5: 0.0558 recall@10: 0.0887 recall@20: 0.1354 ] [ndcg@5: 0.0554 ndcg@10: 0.0669 ndcg@20: 0.0822 ] 
2024-06-22 15:37:08,947 - Epoch 225 Validation set [recall@5: 0.0562 recall@10: 0.0882 recall@20: 0.1355 ] [ndcg@5: 0.0555 ndcg@10: 0.0667 ndcg@20: 0.0821 ] 
2024-06-22 15:37:12,325 - Epoch 228 Validation set [recall@5: 0.0560 recall@10: 0.0888 recall@20: 0.1349 ] [ndcg@5: 0.0555 ndcg@10: 0.0669 ndcg@20: 0.0819 ] 
2024-06-22 15:37:13,636 - [recall@5: 0.0562 recall@10: 0.0885 recall@20: 0.1364 ] [ndcg@5: 0.0555 ndcg@10: 0.0668 ndcg@20: 0.0824 ] 
2024-06-22 15:37:15,176 - [recall@5: 0.0540 recall@10: 0.0869 recall@20: 0.1346 ] [ndcg@5: 0.0542 ndcg@10: 0.0652 ndcg@20: 0.0807 ] 
2024-06-22 15:37:15,204 - Save model parameters to ./encoder/checkpoint/gccf/gccf-amazon-2023.pth
2024-06-22 15:37:15,205 - Best Epoch 213. Final test result: {'recall': array([0.05400997, 0.08686371, 0.1346364 ]), 'ndcg': array([0.05415536, 0.06521695, 0.08073108])}.
