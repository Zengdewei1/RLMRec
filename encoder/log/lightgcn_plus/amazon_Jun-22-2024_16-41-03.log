2024-06-22 16:41:03,684 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'lightgcn_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2, 'amazon': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'yelp': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'steam': {'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.001, 'kd_temperature': 0.1}}}
2024-06-22 16:41:18,011 - Epoch   0 Validation set [recall@5: 0.0013 recall@10: 0.0025 recall@20: 0.0041 ] [ndcg@5: 0.0012 ndcg@10: 0.0016 ndcg@20: 0.0022 ] 
2024-06-22 16:41:28,314 - Epoch   3 Validation set [recall@5: 0.0013 recall@10: 0.0022 recall@20: 0.0039 ] [ndcg@5: 0.0010 ndcg@10: 0.0014 ndcg@20: 0.0019 ] 
2024-06-22 16:41:37,985 - Epoch   6 Validation set [recall@5: 0.0013 recall@10: 0.0021 recall@20: 0.0044 ] [ndcg@5: 0.0011 ndcg@10: 0.0014 ndcg@20: 0.0022 ] 
2024-06-22 16:41:44,458 - Epoch   9 Validation set [recall@5: 0.0015 recall@10: 0.0031 recall@20: 0.0055 ] [ndcg@5: 0.0013 ndcg@10: 0.0020 ndcg@20: 0.0028 ] 
2024-06-22 16:41:53,247 - Epoch  12 Validation set [recall@5: 0.0023 recall@10: 0.0041 recall@20: 0.0064 ] [ndcg@5: 0.0019 ndcg@10: 0.0026 ndcg@20: 0.0034 ] 
2024-06-22 16:42:03,546 - Epoch  15 Validation set [recall@5: 0.0026 recall@10: 0.0043 recall@20: 0.0073 ] [ndcg@5: 0.0022 ndcg@10: 0.0029 ndcg@20: 0.0039 ] 
2024-06-22 16:42:12,060 - Epoch  18 Validation set [recall@5: 0.0030 recall@10: 0.0061 recall@20: 0.0100 ] [ndcg@5: 0.0028 ndcg@10: 0.0039 ndcg@20: 0.0052 ] 
2024-06-22 16:42:22,248 - Epoch  21 Validation set [recall@5: 0.0072 recall@10: 0.0124 recall@20: 0.0183 ] [ndcg@5: 0.0070 ndcg@10: 0.0089 ndcg@20: 0.0108 ] 
2024-06-22 16:42:32,307 - Epoch  24 Validation set [recall@5: 0.0147 recall@10: 0.0217 recall@20: 0.0342 ] [ndcg@5: 0.0144 ndcg@10: 0.0168 ndcg@20: 0.0208 ] 
2024-06-22 16:42:38,787 - Epoch  27 Validation set [recall@5: 0.0218 recall@10: 0.0341 recall@20: 0.0535 ] [ndcg@5: 0.0222 ndcg@10: 0.0262 ndcg@20: 0.0325 ] 
2024-06-22 16:42:49,358 - Epoch  30 Validation set [recall@5: 0.0253 recall@10: 0.0401 recall@20: 0.0637 ] [ndcg@5: 0.0264 ndcg@10: 0.0311 ndcg@20: 0.0387 ] 
2024-06-22 16:42:58,816 - Epoch  33 Validation set [recall@5: 0.0309 recall@10: 0.0497 recall@20: 0.0782 ] [ndcg@5: 0.0329 ndcg@10: 0.0390 ndcg@20: 0.0482 ] 
2024-06-22 16:43:08,399 - Epoch  36 Validation set [recall@5: 0.0339 recall@10: 0.0568 recall@20: 0.0890 ] [ndcg@5: 0.0357 ndcg@10: 0.0433 ndcg@20: 0.0539 ] 
2024-06-22 16:43:18,799 - Epoch  39 Validation set [recall@5: 0.0374 recall@10: 0.0624 recall@20: 0.0951 ] [ndcg@5: 0.0381 ndcg@10: 0.0468 ndcg@20: 0.0574 ] 
2024-06-22 16:43:27,474 - Epoch  42 Validation set [recall@5: 0.0395 recall@10: 0.0654 recall@20: 0.0994 ] [ndcg@5: 0.0398 ndcg@10: 0.0487 ndcg@20: 0.0599 ] 
2024-06-22 16:43:37,881 - Epoch  45 Validation set [recall@5: 0.0414 recall@10: 0.0675 recall@20: 0.1045 ] [ndcg@5: 0.0418 ndcg@10: 0.0508 ndcg@20: 0.0628 ] 
2024-06-22 16:43:48,368 - Epoch  48 Validation set [recall@5: 0.0430 recall@10: 0.0697 recall@20: 0.1068 ] [ndcg@5: 0.0437 ndcg@10: 0.0528 ndcg@20: 0.0649 ] 
2024-06-22 16:43:59,219 - Epoch  51 Validation set [recall@5: 0.0439 recall@10: 0.0716 recall@20: 0.1093 ] [ndcg@5: 0.0446 ndcg@10: 0.0541 ndcg@20: 0.0665 ] 
2024-06-22 16:44:09,368 - Epoch  54 Validation set [recall@5: 0.0454 recall@10: 0.0727 recall@20: 0.1118 ] [ndcg@5: 0.0459 ndcg@10: 0.0551 ndcg@20: 0.0681 ] 
2024-06-22 16:44:18,185 - Epoch  57 Validation set [recall@5: 0.0465 recall@10: 0.0746 recall@20: 0.1143 ] [ndcg@5: 0.0467 ndcg@10: 0.0563 ndcg@20: 0.0693 ] 
2024-06-22 16:44:28,707 - Epoch  60 Validation set [recall@5: 0.0480 recall@10: 0.0751 recall@20: 0.1161 ] [ndcg@5: 0.0478 ndcg@10: 0.0570 ndcg@20: 0.0705 ] 
2024-06-22 16:44:35,183 - Epoch  63 Validation set [recall@5: 0.0485 recall@10: 0.0763 recall@20: 0.1174 ] [ndcg@5: 0.0485 ndcg@10: 0.0578 ndcg@20: 0.0713 ] 
2024-06-22 16:44:42,004 - Epoch  66 Validation set [recall@5: 0.0492 recall@10: 0.0772 recall@20: 0.1178 ] [ndcg@5: 0.0487 ndcg@10: 0.0583 ndcg@20: 0.0716 ] 
2024-06-22 16:44:48,870 - Epoch  69 Validation set [recall@5: 0.0498 recall@10: 0.0772 recall@20: 0.1187 ] [ndcg@5: 0.0494 ndcg@10: 0.0588 ndcg@20: 0.0723 ] 
2024-06-22 16:44:56,114 - Epoch  72 Validation set [recall@5: 0.0499 recall@10: 0.0782 recall@20: 0.1196 ] [ndcg@5: 0.0496 ndcg@10: 0.0593 ndcg@20: 0.0729 ] 
2024-06-22 16:45:01,359 - Epoch  75 Validation set [recall@5: 0.0500 recall@10: 0.0790 recall@20: 0.1201 ] [ndcg@5: 0.0495 ndcg@10: 0.0596 ndcg@20: 0.0731 ] 
2024-06-22 16:45:05,774 - Epoch  78 Validation set [recall@5: 0.0502 recall@10: 0.0792 recall@20: 0.1208 ] [ndcg@5: 0.0498 ndcg@10: 0.0600 ndcg@20: 0.0736 ] 
2024-06-22 16:45:15,493 - Epoch  81 Validation set [recall@5: 0.0503 recall@10: 0.0793 recall@20: 0.1209 ] [ndcg@5: 0.0498 ndcg@10: 0.0599 ndcg@20: 0.0735 ] 
2024-06-22 16:45:21,501 - Epoch  84 Validation set [recall@5: 0.0507 recall@10: 0.0797 recall@20: 0.1216 ] [ndcg@5: 0.0501 ndcg@10: 0.0601 ndcg@20: 0.0737 ] 
2024-06-22 16:45:32,699 - Epoch  87 Validation set [recall@5: 0.0508 recall@10: 0.0789 recall@20: 0.1224 ] [ndcg@5: 0.0501 ndcg@10: 0.0599 ndcg@20: 0.0741 ] 
2024-06-22 16:45:41,958 - Epoch  90 Validation set [recall@5: 0.0514 recall@10: 0.0803 recall@20: 0.1228 ] [ndcg@5: 0.0504 ndcg@10: 0.0605 ndcg@20: 0.0743 ] 
2024-06-22 16:45:52,056 - Epoch  93 Validation set [recall@5: 0.0515 recall@10: 0.0798 recall@20: 0.1226 ] [ndcg@5: 0.0508 ndcg@10: 0.0605 ndcg@20: 0.0744 ] 
2024-06-22 16:46:01,547 - Epoch  96 Validation set [recall@5: 0.0518 recall@10: 0.0803 recall@20: 0.1223 ] [ndcg@5: 0.0509 ndcg@10: 0.0607 ndcg@20: 0.0744 ] 
2024-06-22 16:46:09,416 - Epoch  99 Validation set [recall@5: 0.0517 recall@10: 0.0801 recall@20: 0.1237 ] [ndcg@5: 0.0509 ndcg@10: 0.0607 ndcg@20: 0.0750 ] 
2024-06-22 16:46:13,900 - Epoch 102 Validation set [recall@5: 0.0516 recall@10: 0.0800 recall@20: 0.1230 ] [ndcg@5: 0.0510 ndcg@10: 0.0607 ndcg@20: 0.0748 ] 
2024-06-22 16:46:23,731 - Epoch 105 Validation set [recall@5: 0.0523 recall@10: 0.0805 recall@20: 0.1225 ] [ndcg@5: 0.0512 ndcg@10: 0.0608 ndcg@20: 0.0745 ] 
2024-06-22 16:46:32,776 - Epoch 108 Validation set [recall@5: 0.0524 recall@10: 0.0796 recall@20: 0.1227 ] [ndcg@5: 0.0511 ndcg@10: 0.0603 ndcg@20: 0.0745 ] 
2024-06-22 16:46:41,557 - Epoch 111 Validation set [recall@5: 0.0523 recall@10: 0.0802 recall@20: 0.1234 ] [ndcg@5: 0.0511 ndcg@10: 0.0607 ndcg@20: 0.0748 ] 
2024-06-22 16:46:48,153 - Epoch 114 Validation set [recall@5: 0.0522 recall@10: 0.0806 recall@20: 0.1223 ] [ndcg@5: 0.0510 ndcg@10: 0.0608 ndcg@20: 0.0745 ] 
2024-06-22 16:46:49,600 - [recall@5: 0.0517 recall@10: 0.0801 recall@20: 0.1237 ] [ndcg@5: 0.0509 ndcg@10: 0.0607 ndcg@20: 0.0750 ] 
2024-06-22 16:46:51,249 - [recall@5: 0.0495 recall@10: 0.0793 recall@20: 0.1218 ] [ndcg@5: 0.0497 ndcg@10: 0.0602 ndcg@20: 0.0740 ] 
2024-06-22 16:46:51,275 - Save model parameters to ./encoder/checkpoint/lightgcn_plus/lightgcn_plus-amazon-2023.pth
2024-06-22 16:46:51,276 - Best Epoch 99. Final test result: {'recall': array([0.04946709, 0.07927141, 0.12176014]), 'ndcg': array([0.04972152, 0.06024942, 0.07396272])}.
