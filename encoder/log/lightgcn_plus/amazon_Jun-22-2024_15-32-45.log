2024-06-22 15:32:45,585 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'lightgcn_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2, 'amazon': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'yelp': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'steam': {'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.001, 'kd_temperature': 0.1}}}
2024-06-22 15:32:52,193 - Epoch   0 Validation set [recall@5: 0.0009 recall@10: 0.0018 recall@20: 0.0043 ] [ndcg@5: 0.0010 ndcg@10: 0.0013 ndcg@20: 0.0021 ] 
2024-06-22 15:33:02,303 - Epoch   3 Validation set [recall@5: 0.0010 recall@10: 0.0018 recall@20: 0.0032 ] [ndcg@5: 0.0009 ndcg@10: 0.0012 ndcg@20: 0.0017 ] 
2024-06-22 15:33:12,528 - Epoch   6 Validation set [recall@5: 0.0013 recall@10: 0.0018 recall@20: 0.0036 ] [ndcg@5: 0.0013 ndcg@10: 0.0014 ndcg@20: 0.0020 ] 
2024-06-22 15:33:23,285 - Epoch   9 Validation set [recall@5: 0.0016 recall@10: 0.0027 recall@20: 0.0046 ] [ndcg@5: 0.0015 ndcg@10: 0.0018 ndcg@20: 0.0024 ] 
2024-06-22 15:33:29,018 - Epoch  12 Validation set [recall@5: 0.0016 recall@10: 0.0030 recall@20: 0.0056 ] [ndcg@5: 0.0015 ndcg@10: 0.0020 ndcg@20: 0.0029 ] 
2024-06-22 15:33:38,182 - Epoch  15 Validation set [recall@5: 0.0022 recall@10: 0.0040 recall@20: 0.0067 ] [ndcg@5: 0.0020 ndcg@10: 0.0026 ndcg@20: 0.0035 ] 
2024-06-22 15:33:47,641 - Epoch  18 Validation set [recall@5: 0.0032 recall@10: 0.0051 recall@20: 0.0090 ] [ndcg@5: 0.0028 ndcg@10: 0.0036 ndcg@20: 0.0048 ] 
2024-06-22 15:33:56,799 - Epoch  21 Validation set [recall@5: 0.0046 recall@10: 0.0090 recall@20: 0.0151 ] [ndcg@5: 0.0049 ndcg@10: 0.0064 ndcg@20: 0.0084 ] 
2024-06-22 15:34:01,185 - Epoch  24 Validation set [recall@5: 0.0122 recall@10: 0.0216 recall@20: 0.0349 ] [ndcg@5: 0.0125 ndcg@10: 0.0156 ndcg@20: 0.0200 ] 
2024-06-22 15:34:11,108 - Epoch  27 Validation set [recall@5: 0.0155 recall@10: 0.0267 recall@20: 0.0466 ] [ndcg@5: 0.0157 ndcg@10: 0.0196 ndcg@20: 0.0261 ] 
2024-06-22 15:34:21,630 - Epoch  30 Validation set [recall@5: 0.0203 recall@10: 0.0356 recall@20: 0.0589 ] [ndcg@5: 0.0209 ndcg@10: 0.0261 ndcg@20: 0.0337 ] 
2024-06-22 15:34:30,355 - Epoch  33 Validation set [recall@5: 0.0291 recall@10: 0.0477 recall@20: 0.0732 ] [ndcg@5: 0.0300 ndcg@10: 0.0363 ndcg@20: 0.0445 ] 
2024-06-22 15:34:40,932 - Epoch  36 Validation set [recall@5: 0.0347 recall@10: 0.0552 recall@20: 0.0836 ] [ndcg@5: 0.0350 ndcg@10: 0.0419 ndcg@20: 0.0512 ] 
2024-06-22 15:34:47,857 - Epoch  39 Validation set [recall@5: 0.0375 recall@10: 0.0598 recall@20: 0.0910 ] [ndcg@5: 0.0378 ndcg@10: 0.0456 ndcg@20: 0.0557 ] 
2024-06-22 15:34:52,177 - Epoch  42 Validation set [recall@5: 0.0401 recall@10: 0.0644 recall@20: 0.0970 ] [ndcg@5: 0.0401 ndcg@10: 0.0486 ndcg@20: 0.0592 ] 
2024-06-22 15:35:03,202 - Epoch  45 Validation set [recall@5: 0.0422 recall@10: 0.0665 recall@20: 0.1012 ] [ndcg@5: 0.0419 ndcg@10: 0.0503 ndcg@20: 0.0616 ] 
2024-06-22 15:35:11,555 - Epoch  48 Validation set [recall@5: 0.0442 recall@10: 0.0691 recall@20: 0.1039 ] [ndcg@5: 0.0435 ndcg@10: 0.0522 ndcg@20: 0.0634 ] 
2024-06-22 15:35:21,921 - Epoch  51 Validation set [recall@5: 0.0448 recall@10: 0.0713 recall@20: 0.1071 ] [ndcg@5: 0.0443 ndcg@10: 0.0535 ndcg@20: 0.0651 ] 
2024-06-22 15:35:27,677 - Epoch  54 Validation set [recall@5: 0.0459 recall@10: 0.0732 recall@20: 0.1089 ] [ndcg@5: 0.0454 ndcg@10: 0.0549 ndcg@20: 0.0665 ] 
2024-06-22 15:35:35,327 - Epoch  57 Validation set [recall@5: 0.0472 recall@10: 0.0736 recall@20: 0.1111 ] [ndcg@5: 0.0462 ndcg@10: 0.0553 ndcg@20: 0.0676 ] 
2024-06-22 15:35:41,555 - Epoch  60 Validation set [recall@5: 0.0484 recall@10: 0.0753 recall@20: 0.1130 ] [ndcg@5: 0.0473 ndcg@10: 0.0566 ndcg@20: 0.0688 ] 
2024-06-22 15:35:52,435 - Epoch  63 Validation set [recall@5: 0.0490 recall@10: 0.0759 recall@20: 0.1133 ] [ndcg@5: 0.0476 ndcg@10: 0.0569 ndcg@20: 0.0692 ] 
2024-06-22 15:35:58,923 - Epoch  66 Validation set [recall@5: 0.0493 recall@10: 0.0766 recall@20: 0.1151 ] [ndcg@5: 0.0476 ndcg@10: 0.0572 ndcg@20: 0.0698 ] 
2024-06-22 15:36:09,109 - Epoch  69 Validation set [recall@5: 0.0496 recall@10: 0.0773 recall@20: 0.1164 ] [ndcg@5: 0.0481 ndcg@10: 0.0576 ndcg@20: 0.0705 ] 
2024-06-22 15:36:19,981 - Epoch  72 Validation set [recall@5: 0.0492 recall@10: 0.0775 recall@20: 0.1166 ] [ndcg@5: 0.0479 ndcg@10: 0.0578 ndcg@20: 0.0707 ] 
2024-06-22 15:36:28,502 - Epoch  75 Validation set [recall@5: 0.0498 recall@10: 0.0779 recall@20: 0.1184 ] [ndcg@5: 0.0485 ndcg@10: 0.0583 ndcg@20: 0.0715 ] 
2024-06-22 15:36:34,701 - Epoch  78 Validation set [recall@5: 0.0499 recall@10: 0.0777 recall@20: 0.1199 ] [ndcg@5: 0.0490 ndcg@10: 0.0587 ndcg@20: 0.0724 ] 
2024-06-22 15:36:41,908 - Epoch  81 Validation set [recall@5: 0.0497 recall@10: 0.0777 recall@20: 0.1202 ] [ndcg@5: 0.0489 ndcg@10: 0.0586 ndcg@20: 0.0726 ] 
2024-06-22 15:36:50,413 - Epoch  84 Validation set [recall@5: 0.0497 recall@10: 0.0785 recall@20: 0.1200 ] [ndcg@5: 0.0488 ndcg@10: 0.0589 ndcg@20: 0.0725 ] 
2024-06-22 15:36:57,651 - Epoch  87 Validation set [recall@5: 0.0503 recall@10: 0.0790 recall@20: 0.1209 ] [ndcg@5: 0.0491 ndcg@10: 0.0591 ndcg@20: 0.0729 ] 
2024-06-22 15:37:07,093 - Epoch  90 Validation set [recall@5: 0.0498 recall@10: 0.0794 recall@20: 0.1209 ] [ndcg@5: 0.0491 ndcg@10: 0.0594 ndcg@20: 0.0731 ] 
2024-06-22 15:37:15,589 - Epoch  93 Validation set [recall@5: 0.0497 recall@10: 0.0799 recall@20: 0.1210 ] [ndcg@5: 0.0492 ndcg@10: 0.0597 ndcg@20: 0.0732 ] 
2024-06-22 15:37:19,850 - Epoch  96 Validation set [recall@5: 0.0494 recall@10: 0.0801 recall@20: 0.1212 ] [ndcg@5: 0.0492 ndcg@10: 0.0599 ndcg@20: 0.0734 ] 
2024-06-22 15:37:25,073 - Epoch  99 Validation set [recall@5: 0.0498 recall@10: 0.0803 recall@20: 0.1222 ] [ndcg@5: 0.0494 ndcg@10: 0.0602 ndcg@20: 0.0739 ] 
2024-06-22 15:37:29,359 - Epoch 102 Validation set [recall@5: 0.0498 recall@10: 0.0804 recall@20: 0.1223 ] [ndcg@5: 0.0493 ndcg@10: 0.0601 ndcg@20: 0.0738 ] 
2024-06-22 15:37:33,338 - Epoch 105 Validation set [recall@5: 0.0501 recall@10: 0.0804 recall@20: 0.1218 ] [ndcg@5: 0.0494 ndcg@10: 0.0601 ndcg@20: 0.0736 ] 
2024-06-22 15:37:37,331 - Epoch 108 Validation set [recall@5: 0.0496 recall@10: 0.0804 recall@20: 0.1216 ] [ndcg@5: 0.0491 ndcg@10: 0.0601 ndcg@20: 0.0736 ] 
2024-06-22 15:37:41,320 - Epoch 111 Validation set [recall@5: 0.0497 recall@10: 0.0806 recall@20: 0.1217 ] [ndcg@5: 0.0494 ndcg@10: 0.0603 ndcg@20: 0.0737 ] 
2024-06-22 15:37:45,302 - Epoch 114 Validation set [recall@5: 0.0504 recall@10: 0.0808 recall@20: 0.1225 ] [ndcg@5: 0.0495 ndcg@10: 0.0603 ndcg@20: 0.0739 ] 
2024-06-22 15:37:50,005 - Epoch 117 Validation set [recall@5: 0.0501 recall@10: 0.0810 recall@20: 0.1219 ] [ndcg@5: 0.0495 ndcg@10: 0.0604 ndcg@20: 0.0738 ] 
2024-06-22 15:37:55,013 - Epoch 120 Validation set [recall@5: 0.0502 recall@10: 0.0809 recall@20: 0.1226 ] [ndcg@5: 0.0496 ndcg@10: 0.0605 ndcg@20: 0.0742 ] 
2024-06-22 15:37:59,565 - Epoch 123 Validation set [recall@5: 0.0502 recall@10: 0.0813 recall@20: 0.1218 ] [ndcg@5: 0.0497 ndcg@10: 0.0607 ndcg@20: 0.0739 ] 
2024-06-22 15:38:04,745 - Epoch 126 Validation set [recall@5: 0.0508 recall@10: 0.0815 recall@20: 0.1217 ] [ndcg@5: 0.0499 ndcg@10: 0.0609 ndcg@20: 0.0740 ] 
2024-06-22 15:38:09,390 - Epoch 129 Validation set [recall@5: 0.0504 recall@10: 0.0819 recall@20: 0.1209 ] [ndcg@5: 0.0497 ndcg@10: 0.0609 ndcg@20: 0.0736 ] 
2024-06-22 15:38:14,355 - Epoch 132 Validation set [recall@5: 0.0499 recall@10: 0.0814 recall@20: 0.1204 ] [ndcg@5: 0.0494 ndcg@10: 0.0606 ndcg@20: 0.0734 ] 
2024-06-22 15:38:19,361 - Epoch 135 Validation set [recall@5: 0.0502 recall@10: 0.0814 recall@20: 0.1207 ] [ndcg@5: 0.0497 ndcg@10: 0.0607 ndcg@20: 0.0734 ] 
2024-06-22 15:38:21,354 - [recall@5: 0.0502 recall@10: 0.0809 recall@20: 0.1226 ] [ndcg@5: 0.0496 ndcg@10: 0.0605 ndcg@20: 0.0742 ] 
2024-06-22 15:38:22,683 - [recall@5: 0.0492 recall@10: 0.0760 recall@20: 0.1180 ] [ndcg@5: 0.0493 ndcg@10: 0.0587 ndcg@20: 0.0723 ] 
2024-06-22 15:38:22,713 - Save model parameters to ./encoder/checkpoint/lightgcn_plus/lightgcn_plus-amazon-2023.pth
2024-06-22 15:38:22,713 - Best Epoch 120. Final test result: {'recall': array([0.04921797, 0.07604213, 0.11797005]), 'ndcg': array([0.04928784, 0.05866116, 0.07228526])}.
