2024-06-24 15:41:14,993 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'lightgcn_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2, 'amazon': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'yelp': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'steam': {'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.001, 'kd_temperature': 0.1}}}
2024-06-24 15:41:30,681 - Epoch   0 Validation set [recall@5: 0.0262 recall@10: 0.0434 recall@20: 0.0681 ] [ndcg@5: 0.0254 ndcg@10: 0.0315 ndcg@20: 0.0396 ] 
2024-06-24 15:41:39,042 - Epoch   3 Validation set [recall@5: 0.0232 recall@10: 0.0382 recall@20: 0.0615 ] [ndcg@5: 0.0226 ndcg@10: 0.0280 ndcg@20: 0.0357 ] 
2024-06-24 15:41:46,879 - Epoch   6 Validation set [recall@5: 0.0272 recall@10: 0.0470 recall@20: 0.0752 ] [ndcg@5: 0.0269 ndcg@10: 0.0340 ndcg@20: 0.0433 ] 
2024-06-24 15:41:55,309 - Epoch   9 Validation set [recall@5: 0.0320 recall@10: 0.0525 recall@20: 0.0833 ] [ndcg@5: 0.0319 ndcg@10: 0.0390 ndcg@20: 0.0491 ] 
2024-06-24 15:42:04,079 - Epoch  12 Validation set [recall@5: 0.0369 recall@10: 0.0603 recall@20: 0.0933 ] [ndcg@5: 0.0369 ndcg@10: 0.0451 ndcg@20: 0.0558 ] 
2024-06-24 15:42:12,088 - Epoch  15 Validation set [recall@5: 0.0409 recall@10: 0.0651 recall@20: 0.1004 ] [ndcg@5: 0.0407 ndcg@10: 0.0490 ndcg@20: 0.0605 ] 
2024-06-24 15:42:20,337 - Epoch  18 Validation set [recall@5: 0.0433 recall@10: 0.0684 recall@20: 0.1052 ] [ndcg@5: 0.0432 ndcg@10: 0.0518 ndcg@20: 0.0637 ] 
2024-06-24 15:42:28,718 - Epoch  21 Validation set [recall@5: 0.0452 recall@10: 0.0707 recall@20: 0.1089 ] [ndcg@5: 0.0453 ndcg@10: 0.0539 ndcg@20: 0.0664 ] 
2024-06-24 15:42:36,590 - Epoch  24 Validation set [recall@5: 0.0471 recall@10: 0.0742 recall@20: 0.1116 ] [ndcg@5: 0.0470 ndcg@10: 0.0561 ndcg@20: 0.0683 ] 
2024-06-24 15:42:45,164 - Epoch  27 Validation set [recall@5: 0.0484 recall@10: 0.0760 recall@20: 0.1155 ] [ndcg@5: 0.0482 ndcg@10: 0.0576 ndcg@20: 0.0706 ] 
2024-06-24 15:42:54,232 - Epoch  30 Validation set [recall@5: 0.0495 recall@10: 0.0788 recall@20: 0.1180 ] [ndcg@5: 0.0492 ndcg@10: 0.0592 ndcg@20: 0.0721 ] 
2024-06-24 15:43:02,111 - Epoch  33 Validation set [recall@5: 0.0505 recall@10: 0.0805 recall@20: 0.1203 ] [ndcg@5: 0.0500 ndcg@10: 0.0605 ndcg@20: 0.0735 ] 
2024-06-24 15:43:10,873 - Epoch  36 Validation set [recall@5: 0.0518 recall@10: 0.0811 recall@20: 0.1225 ] [ndcg@5: 0.0514 ndcg@10: 0.0614 ndcg@20: 0.0751 ] 
2024-06-24 15:43:19,422 - Epoch  39 Validation set [recall@5: 0.0526 recall@10: 0.0822 recall@20: 0.1239 ] [ndcg@5: 0.0524 ndcg@10: 0.0625 ndcg@20: 0.0762 ] 
2024-06-24 15:43:27,625 - Epoch  42 Validation set [recall@5: 0.0534 recall@10: 0.0840 recall@20: 0.1259 ] [ndcg@5: 0.0527 ndcg@10: 0.0634 ndcg@20: 0.0771 ] 
2024-06-24 15:43:36,558 - Epoch  45 Validation set [recall@5: 0.0537 recall@10: 0.0840 recall@20: 0.1287 ] [ndcg@5: 0.0536 ndcg@10: 0.0641 ndcg@20: 0.0786 ] 
2024-06-24 15:43:43,879 - Epoch  48 Validation set [recall@5: 0.0539 recall@10: 0.0847 recall@20: 0.1288 ] [ndcg@5: 0.0537 ndcg@10: 0.0642 ndcg@20: 0.0787 ] 
2024-06-24 15:43:52,465 - Epoch  51 Validation set [recall@5: 0.0546 recall@10: 0.0860 recall@20: 0.1310 ] [ndcg@5: 0.0542 ndcg@10: 0.0650 ndcg@20: 0.0798 ] 
2024-06-24 15:44:01,188 - Epoch  54 Validation set [recall@5: 0.0550 recall@10: 0.0870 recall@20: 0.1324 ] [ndcg@5: 0.0547 ndcg@10: 0.0655 ndcg@20: 0.0804 ] 
2024-06-24 15:44:09,458 - Epoch  57 Validation set [recall@5: 0.0555 recall@10: 0.0880 recall@20: 0.1347 ] [ndcg@5: 0.0550 ndcg@10: 0.0662 ndcg@20: 0.0814 ] 
2024-06-24 15:44:17,326 - Epoch  60 Validation set [recall@5: 0.0559 recall@10: 0.0887 recall@20: 0.1361 ] [ndcg@5: 0.0554 ndcg@10: 0.0667 ndcg@20: 0.0821 ] 
2024-06-24 15:44:25,624 - Epoch  63 Validation set [recall@5: 0.0572 recall@10: 0.0900 recall@20: 0.1364 ] [ndcg@5: 0.0561 ndcg@10: 0.0674 ndcg@20: 0.0824 ] 
2024-06-24 15:44:33,449 - Epoch  66 Validation set [recall@5: 0.0576 recall@10: 0.0899 recall@20: 0.1376 ] [ndcg@5: 0.0568 ndcg@10: 0.0677 ndcg@20: 0.0832 ] 
2024-06-24 15:44:42,126 - Epoch  69 Validation set [recall@5: 0.0575 recall@10: 0.0904 recall@20: 0.1381 ] [ndcg@5: 0.0570 ndcg@10: 0.0682 ndcg@20: 0.0837 ] 
2024-06-24 15:44:50,993 - Epoch  72 Validation set [recall@5: 0.0578 recall@10: 0.0910 recall@20: 0.1386 ] [ndcg@5: 0.0572 ndcg@10: 0.0683 ndcg@20: 0.0839 ] 
2024-06-24 15:45:00,094 - Epoch  75 Validation set [recall@5: 0.0583 recall@10: 0.0918 recall@20: 0.1387 ] [ndcg@5: 0.0575 ndcg@10: 0.0688 ndcg@20: 0.0841 ] 
2024-06-24 15:45:08,171 - Epoch  78 Validation set [recall@5: 0.0584 recall@10: 0.0917 recall@20: 0.1392 ] [ndcg@5: 0.0574 ndcg@10: 0.0688 ndcg@20: 0.0843 ] 
2024-06-24 15:45:16,280 - Epoch  81 Validation set [recall@5: 0.0586 recall@10: 0.0918 recall@20: 0.1395 ] [ndcg@5: 0.0579 ndcg@10: 0.0693 ndcg@20: 0.0849 ] 
2024-06-24 15:45:25,319 - Epoch  84 Validation set [recall@5: 0.0583 recall@10: 0.0926 recall@20: 0.1401 ] [ndcg@5: 0.0574 ndcg@10: 0.0694 ndcg@20: 0.0848 ] 
2024-06-24 15:45:33,707 - Epoch  87 Validation set [recall@5: 0.0583 recall@10: 0.0930 recall@20: 0.1405 ] [ndcg@5: 0.0575 ndcg@10: 0.0696 ndcg@20: 0.0851 ] 
2024-06-24 15:45:42,041 - Epoch  90 Validation set [recall@5: 0.0589 recall@10: 0.0935 recall@20: 0.1409 ] [ndcg@5: 0.0579 ndcg@10: 0.0699 ndcg@20: 0.0853 ] 
2024-06-24 15:45:49,859 - Epoch  93 Validation set [recall@5: 0.0579 recall@10: 0.0934 recall@20: 0.1415 ] [ndcg@5: 0.0577 ndcg@10: 0.0700 ndcg@20: 0.0856 ] 
2024-06-24 15:45:59,759 - Epoch  96 Validation set [recall@5: 0.0581 recall@10: 0.0939 recall@20: 0.1415 ] [ndcg@5: 0.0579 ndcg@10: 0.0703 ndcg@20: 0.0857 ] 
2024-06-24 15:46:07,911 - Epoch  99 Validation set [recall@5: 0.0589 recall@10: 0.0944 recall@20: 0.1430 ] [ndcg@5: 0.0582 ndcg@10: 0.0705 ndcg@20: 0.0862 ] 
2024-06-24 15:46:16,198 - Epoch 102 Validation set [recall@5: 0.0584 recall@10: 0.0945 recall@20: 0.1432 ] [ndcg@5: 0.0582 ndcg@10: 0.0707 ndcg@20: 0.0865 ] 
2024-06-24 15:46:25,162 - Epoch 105 Validation set [recall@5: 0.0590 recall@10: 0.0949 recall@20: 0.1432 ] [ndcg@5: 0.0587 ndcg@10: 0.0711 ndcg@20: 0.0867 ] 
2024-06-24 15:46:33,178 - Epoch 108 Validation set [recall@5: 0.0593 recall@10: 0.0946 recall@20: 0.1427 ] [ndcg@5: 0.0589 ndcg@10: 0.0711 ndcg@20: 0.0867 ] 
2024-06-24 15:46:41,347 - Epoch 111 Validation set [recall@5: 0.0588 recall@10: 0.0952 recall@20: 0.1430 ] [ndcg@5: 0.0588 ndcg@10: 0.0712 ndcg@20: 0.0868 ] 
2024-06-24 15:46:50,709 - Epoch 114 Validation set [recall@5: 0.0590 recall@10: 0.0948 recall@20: 0.1433 ] [ndcg@5: 0.0587 ndcg@10: 0.0709 ndcg@20: 0.0868 ] 
2024-06-24 15:46:58,741 - Epoch 117 Validation set [recall@5: 0.0598 recall@10: 0.0944 recall@20: 0.1437 ] [ndcg@5: 0.0591 ndcg@10: 0.0709 ndcg@20: 0.0871 ] 
2024-06-24 15:47:07,345 - Epoch 120 Validation set [recall@5: 0.0601 recall@10: 0.0944 recall@20: 0.1443 ] [ndcg@5: 0.0592 ndcg@10: 0.0710 ndcg@20: 0.0873 ] 
2024-06-24 15:47:15,396 - Epoch 123 Validation set [recall@5: 0.0606 recall@10: 0.0948 recall@20: 0.1448 ] [ndcg@5: 0.0597 ndcg@10: 0.0713 ndcg@20: 0.0876 ] 
2024-06-24 15:47:24,371 - Epoch 126 Validation set [recall@5: 0.0599 recall@10: 0.0948 recall@20: 0.1447 ] [ndcg@5: 0.0597 ndcg@10: 0.0716 ndcg@20: 0.0878 ] 
2024-06-24 15:47:32,594 - Epoch 129 Validation set [recall@5: 0.0599 recall@10: 0.0944 recall@20: 0.1453 ] [ndcg@5: 0.0597 ndcg@10: 0.0715 ndcg@20: 0.0881 ] 
2024-06-24 15:47:40,549 - Epoch 132 Validation set [recall@5: 0.0602 recall@10: 0.0946 recall@20: 0.1452 ] [ndcg@5: 0.0597 ndcg@10: 0.0714 ndcg@20: 0.0878 ] 
2024-06-24 15:47:49,833 - Epoch 135 Validation set [recall@5: 0.0600 recall@10: 0.0945 recall@20: 0.1448 ] [ndcg@5: 0.0598 ndcg@10: 0.0715 ndcg@20: 0.0879 ] 
2024-06-24 15:47:57,448 - Epoch 138 Validation set [recall@5: 0.0601 recall@10: 0.0946 recall@20: 0.1456 ] [ndcg@5: 0.0598 ndcg@10: 0.0714 ndcg@20: 0.0881 ] 
2024-06-24 15:48:06,336 - Epoch 141 Validation set [recall@5: 0.0605 recall@10: 0.0947 recall@20: 0.1453 ] [ndcg@5: 0.0600 ndcg@10: 0.0715 ndcg@20: 0.0880 ] 
2024-06-24 15:48:14,523 - Epoch 144 Validation set [recall@5: 0.0608 recall@10: 0.0955 recall@20: 0.1457 ] [ndcg@5: 0.0602 ndcg@10: 0.0719 ndcg@20: 0.0882 ] 
2024-06-24 15:48:23,219 - Epoch 147 Validation set [recall@5: 0.0606 recall@10: 0.0954 recall@20: 0.1455 ] [ndcg@5: 0.0599 ndcg@10: 0.0717 ndcg@20: 0.0881 ] 
2024-06-24 15:48:32,083 - Epoch 150 Validation set [recall@5: 0.0607 recall@10: 0.0948 recall@20: 0.1465 ] [ndcg@5: 0.0600 ndcg@10: 0.0718 ndcg@20: 0.0886 ] 
2024-06-24 15:48:40,991 - Epoch 153 Validation set [recall@5: 0.0603 recall@10: 0.0945 recall@20: 0.1465 ] [ndcg@5: 0.0597 ndcg@10: 0.0713 ndcg@20: 0.0883 ] 
2024-06-24 15:48:50,487 - Epoch 156 Validation set [recall@5: 0.0598 recall@10: 0.0955 recall@20: 0.1465 ] [ndcg@5: 0.0593 ndcg@10: 0.0716 ndcg@20: 0.0882 ] 
2024-06-24 15:48:58,053 - Epoch 159 Validation set [recall@5: 0.0592 recall@10: 0.0956 recall@20: 0.1461 ] [ndcg@5: 0.0591 ndcg@10: 0.0716 ndcg@20: 0.0881 ] 
2024-06-24 15:49:07,015 - Epoch 162 Validation set [recall@5: 0.0591 recall@10: 0.0955 recall@20: 0.1471 ] [ndcg@5: 0.0588 ndcg@10: 0.0714 ndcg@20: 0.0882 ] 
2024-06-24 15:49:15,125 - Epoch 165 Validation set [recall@5: 0.0598 recall@10: 0.0958 recall@20: 0.1464 ] [ndcg@5: 0.0592 ndcg@10: 0.0715 ndcg@20: 0.0880 ] 
2024-06-24 15:49:23,368 - Epoch 168 Validation set [recall@5: 0.0599 recall@10: 0.0952 recall@20: 0.1465 ] [ndcg@5: 0.0594 ndcg@10: 0.0715 ndcg@20: 0.0883 ] 
2024-06-24 15:49:31,360 - Epoch 171 Validation set [recall@5: 0.0599 recall@10: 0.0957 recall@20: 0.1462 ] [ndcg@5: 0.0595 ndcg@10: 0.0720 ndcg@20: 0.0884 ] 
2024-06-24 15:49:40,018 - Epoch 174 Validation set [recall@5: 0.0604 recall@10: 0.0958 recall@20: 0.1457 ] [ndcg@5: 0.0595 ndcg@10: 0.0717 ndcg@20: 0.0880 ] 
2024-06-24 15:49:48,800 - Epoch 177 Validation set [recall@5: 0.0598 recall@10: 0.0958 recall@20: 0.1460 ] [ndcg@5: 0.0592 ndcg@10: 0.0717 ndcg@20: 0.0881 ] 
2024-06-24 15:49:51,103 - [recall@5: 0.0591 recall@10: 0.0955 recall@20: 0.1471 ] [ndcg@5: 0.0588 ndcg@10: 0.0714 ndcg@20: 0.0882 ] 
2024-06-24 15:49:53,477 - [recall@5: 0.0598 recall@10: 0.0945 recall@20: 0.1434 ] [ndcg@5: 0.0596 ndcg@10: 0.0715 ndcg@20: 0.0874 ] 
2024-06-24 15:49:53,520 - Save model parameters to ./encoder/checkpoint/lightgcn_plus/lightgcn_plus-amazon-2023.pth
2024-06-24 15:49:53,521 - Best Epoch 162. Final test result: {'recall': array([0.05980497, 0.09445039, 0.14338854]), 'ndcg': array([0.05961792, 0.07146406, 0.08740273])}.
