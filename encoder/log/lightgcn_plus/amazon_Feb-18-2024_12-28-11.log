2024-02-18 12:28:11,398 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'lightgcn_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2, 'amazon': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'yelp': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'steam': {'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.001, 'kd_temperature': 0.1}}}
2024-02-18 12:28:17,324 - Epoch   0 Validation set [recall@5: 0.0311 recall@10: 0.0511 recall@20: 0.0816 ] [ndcg@5: 0.0302 ndcg@10: 0.0374 ndcg@20: 0.0474 ] 
2024-02-18 12:28:26,347 - Epoch   3 Validation set [recall@5: 0.0299 recall@10: 0.0492 recall@20: 0.0770 ] [ndcg@5: 0.0290 ndcg@10: 0.0361 ndcg@20: 0.0454 ] 
2024-02-18 12:28:34,709 - Epoch   6 Validation set [recall@5: 0.0296 recall@10: 0.0502 recall@20: 0.0791 ] [ndcg@5: 0.0304 ndcg@10: 0.0375 ndcg@20: 0.0471 ] 
2024-02-18 12:28:42,355 - Epoch   9 Validation set [recall@5: 0.0352 recall@10: 0.0577 recall@20: 0.0900 ] [ndcg@5: 0.0359 ndcg@10: 0.0435 ndcg@20: 0.0541 ] 
2024-02-18 12:28:49,010 - Epoch  12 Validation set [recall@5: 0.0391 recall@10: 0.0648 recall@20: 0.0987 ] [ndcg@5: 0.0398 ndcg@10: 0.0485 ndcg@20: 0.0595 ] 
2024-02-18 12:28:55,541 - Epoch  15 Validation set [recall@5: 0.0426 recall@10: 0.0686 recall@20: 0.1045 ] [ndcg@5: 0.0425 ndcg@10: 0.0514 ndcg@20: 0.0631 ] 
2024-02-18 12:29:02,973 - Epoch  18 Validation set [recall@5: 0.0450 recall@10: 0.0718 recall@20: 0.1094 ] [ndcg@5: 0.0449 ndcg@10: 0.0539 ndcg@20: 0.0662 ] 
2024-02-18 12:29:10,569 - Epoch  21 Validation set [recall@5: 0.0468 recall@10: 0.0726 recall@20: 0.1133 ] [ndcg@5: 0.0462 ndcg@10: 0.0550 ndcg@20: 0.0682 ] 
2024-02-18 12:29:18,311 - Epoch  24 Validation set [recall@5: 0.0487 recall@10: 0.0754 recall@20: 0.1173 ] [ndcg@5: 0.0480 ndcg@10: 0.0571 ndcg@20: 0.0705 ] 
2024-02-18 12:29:24,720 - Epoch  27 Validation set [recall@5: 0.0495 recall@10: 0.0774 recall@20: 0.1204 ] [ndcg@5: 0.0491 ndcg@10: 0.0585 ndcg@20: 0.0724 ] 
2024-02-18 12:29:32,653 - Epoch  30 Validation set [recall@5: 0.0503 recall@10: 0.0797 recall@20: 0.1223 ] [ndcg@5: 0.0498 ndcg@10: 0.0598 ndcg@20: 0.0737 ] 
2024-02-18 12:29:40,990 - Epoch  33 Validation set [recall@5: 0.0518 recall@10: 0.0813 recall@20: 0.1241 ] [ndcg@5: 0.0509 ndcg@10: 0.0608 ndcg@20: 0.0748 ] 
2024-02-18 12:29:47,436 - Epoch  36 Validation set [recall@5: 0.0530 recall@10: 0.0826 recall@20: 0.1271 ] [ndcg@5: 0.0519 ndcg@10: 0.0619 ndcg@20: 0.0766 ] 
2024-02-18 12:29:55,261 - Epoch  39 Validation set [recall@5: 0.0538 recall@10: 0.0834 recall@20: 0.1300 ] [ndcg@5: 0.0529 ndcg@10: 0.0629 ndcg@20: 0.0783 ] 
2024-02-18 12:30:02,147 - Epoch  42 Validation set [recall@5: 0.0543 recall@10: 0.0840 recall@20: 0.1315 ] [ndcg@5: 0.0535 ndcg@10: 0.0637 ndcg@20: 0.0793 ] 
2024-02-18 12:30:09,245 - Epoch  45 Validation set [recall@5: 0.0548 recall@10: 0.0859 recall@20: 0.1325 ] [ndcg@5: 0.0542 ndcg@10: 0.0648 ndcg@20: 0.0802 ] 
2024-02-18 12:30:17,370 - Epoch  48 Validation set [recall@5: 0.0554 recall@10: 0.0872 recall@20: 0.1352 ] [ndcg@5: 0.0549 ndcg@10: 0.0656 ndcg@20: 0.0813 ] 
2024-02-18 12:30:25,509 - Epoch  51 Validation set [recall@5: 0.0558 recall@10: 0.0882 recall@20: 0.1355 ] [ndcg@5: 0.0551 ndcg@10: 0.0662 ndcg@20: 0.0817 ] 
2024-02-18 12:30:31,513 - Epoch  54 Validation set [recall@5: 0.0566 recall@10: 0.0887 recall@20: 0.1370 ] [ndcg@5: 0.0557 ndcg@10: 0.0666 ndcg@20: 0.0825 ] 
2024-02-18 12:30:39,178 - Epoch  57 Validation set [recall@5: 0.0574 recall@10: 0.0903 recall@20: 0.1378 ] [ndcg@5: 0.0561 ndcg@10: 0.0673 ndcg@20: 0.0830 ] 
2024-02-18 12:30:47,229 - Epoch  60 Validation set [recall@5: 0.0580 recall@10: 0.0910 recall@20: 0.1389 ] [ndcg@5: 0.0568 ndcg@10: 0.0682 ndcg@20: 0.0838 ] 
2024-02-18 12:30:54,879 - Epoch  63 Validation set [recall@5: 0.0576 recall@10: 0.0911 recall@20: 0.1391 ] [ndcg@5: 0.0568 ndcg@10: 0.0683 ndcg@20: 0.0841 ] 
2024-02-18 12:31:01,891 - Epoch  66 Validation set [recall@5: 0.0592 recall@10: 0.0923 recall@20: 0.1404 ] [ndcg@5: 0.0577 ndcg@10: 0.0689 ndcg@20: 0.0847 ] 
2024-02-18 12:31:09,576 - Epoch  69 Validation set [recall@5: 0.0590 recall@10: 0.0919 recall@20: 0.1405 ] [ndcg@5: 0.0577 ndcg@10: 0.0690 ndcg@20: 0.0850 ] 
2024-02-18 12:31:15,844 - Epoch  72 Validation set [recall@5: 0.0594 recall@10: 0.0928 recall@20: 0.1423 ] [ndcg@5: 0.0581 ndcg@10: 0.0694 ndcg@20: 0.0858 ] 
2024-02-18 12:31:23,309 - Epoch  75 Validation set [recall@5: 0.0591 recall@10: 0.0936 recall@20: 0.1431 ] [ndcg@5: 0.0583 ndcg@10: 0.0701 ndcg@20: 0.0863 ] 
2024-02-18 12:31:29,348 - Epoch  78 Validation set [recall@5: 0.0591 recall@10: 0.0942 recall@20: 0.1433 ] [ndcg@5: 0.0585 ndcg@10: 0.0705 ndcg@20: 0.0867 ] 
2024-02-18 12:31:36,940 - Epoch  81 Validation set [recall@5: 0.0596 recall@10: 0.0936 recall@20: 0.1435 ] [ndcg@5: 0.0589 ndcg@10: 0.0705 ndcg@20: 0.0869 ] 
2024-02-18 12:31:44,398 - Epoch  84 Validation set [recall@5: 0.0595 recall@10: 0.0952 recall@20: 0.1450 ] [ndcg@5: 0.0586 ndcg@10: 0.0709 ndcg@20: 0.0872 ] 
2024-02-18 12:31:51,178 - Epoch  87 Validation set [recall@5: 0.0600 recall@10: 0.0957 recall@20: 0.1455 ] [ndcg@5: 0.0590 ndcg@10: 0.0714 ndcg@20: 0.0877 ] 
2024-02-18 12:31:59,347 - Epoch  90 Validation set [recall@5: 0.0604 recall@10: 0.0954 recall@20: 0.1454 ] [ndcg@5: 0.0594 ndcg@10: 0.0714 ndcg@20: 0.0878 ] 
2024-02-18 12:32:06,991 - Epoch  93 Validation set [recall@5: 0.0604 recall@10: 0.0959 recall@20: 0.1475 ] [ndcg@5: 0.0595 ndcg@10: 0.0717 ndcg@20: 0.0886 ] 
2024-02-18 12:32:14,747 - Epoch  96 Validation set [recall@5: 0.0599 recall@10: 0.0960 recall@20: 0.1482 ] [ndcg@5: 0.0593 ndcg@10: 0.0719 ndcg@20: 0.0889 ] 
2024-02-18 12:32:23,494 - Epoch  99 Validation set [recall@5: 0.0599 recall@10: 0.0971 recall@20: 0.1486 ] [ndcg@5: 0.0595 ndcg@10: 0.0723 ndcg@20: 0.0892 ] 
2024-02-18 12:32:31,690 - Epoch 102 Validation set [recall@5: 0.0599 recall@10: 0.0966 recall@20: 0.1490 ] [ndcg@5: 0.0594 ndcg@10: 0.0720 ndcg@20: 0.0892 ] 
2024-02-18 12:32:39,782 - Epoch 105 Validation set [recall@5: 0.0606 recall@10: 0.0966 recall@20: 0.1485 ] [ndcg@5: 0.0600 ndcg@10: 0.0722 ndcg@20: 0.0892 ] 
2024-02-18 12:32:46,601 - Epoch 108 Validation set [recall@5: 0.0609 recall@10: 0.0959 recall@20: 0.1484 ] [ndcg@5: 0.0604 ndcg@10: 0.0723 ndcg@20: 0.0895 ] 
2024-02-18 12:32:54,045 - Epoch 111 Validation set [recall@5: 0.0614 recall@10: 0.0968 recall@20: 0.1493 ] [ndcg@5: 0.0606 ndcg@10: 0.0726 ndcg@20: 0.0898 ] 
2024-02-18 12:32:59,645 - Epoch 114 Validation set [recall@5: 0.0615 recall@10: 0.0972 recall@20: 0.1498 ] [ndcg@5: 0.0605 ndcg@10: 0.0727 ndcg@20: 0.0899 ] 
2024-02-18 12:33:07,875 - Epoch 117 Validation set [recall@5: 0.0611 recall@10: 0.0972 recall@20: 0.1501 ] [ndcg@5: 0.0607 ndcg@10: 0.0731 ndcg@20: 0.0903 ] 
2024-02-18 12:33:16,555 - Epoch 120 Validation set [recall@5: 0.0616 recall@10: 0.0988 recall@20: 0.1494 ] [ndcg@5: 0.0608 ndcg@10: 0.0737 ndcg@20: 0.0903 ] 
2024-02-18 12:33:24,568 - Epoch 123 Validation set [recall@5: 0.0619 recall@10: 0.0989 recall@20: 0.1507 ] [ndcg@5: 0.0612 ndcg@10: 0.0740 ndcg@20: 0.0908 ] 
2024-02-18 12:33:31,750 - Epoch 126 Validation set [recall@5: 0.0614 recall@10: 0.0981 recall@20: 0.1494 ] [ndcg@5: 0.0608 ndcg@10: 0.0737 ndcg@20: 0.0904 ] 
2024-02-18 12:33:38,135 - Epoch 129 Validation set [recall@5: 0.0617 recall@10: 0.0985 recall@20: 0.1495 ] [ndcg@5: 0.0613 ndcg@10: 0.0740 ndcg@20: 0.0907 ] 
2024-02-18 12:33:44,436 - Epoch 132 Validation set [recall@5: 0.0617 recall@10: 0.0985 recall@20: 0.1500 ] [ndcg@5: 0.0611 ndcg@10: 0.0738 ndcg@20: 0.0907 ] 
2024-02-18 12:33:52,581 - Epoch 135 Validation set [recall@5: 0.0620 recall@10: 0.0984 recall@20: 0.1498 ] [ndcg@5: 0.0612 ndcg@10: 0.0739 ndcg@20: 0.0907 ] 
2024-02-18 12:33:58,183 - Epoch 138 Validation set [recall@5: 0.0620 recall@10: 0.0986 recall@20: 0.1500 ] [ndcg@5: 0.0615 ndcg@10: 0.0742 ndcg@20: 0.0910 ] 
2024-02-18 12:34:00,042 - [recall@5: 0.0619 recall@10: 0.0989 recall@20: 0.1507 ] [ndcg@5: 0.0612 ndcg@10: 0.0740 ndcg@20: 0.0908 ] 
2024-02-18 12:34:01,874 - [recall@5: 0.0608 recall@10: 0.0976 recall@20: 0.1487 ] [ndcg@5: 0.0610 ndcg@10: 0.0740 ndcg@20: 0.0908 ] 
2024-02-18 12:34:01,918 - Save model parameters to ./encoder/checkpoint/lightgcn_plus/lightgcn_plus-amazon-2023.pth
2024-02-18 12:34:01,919 - Best Epoch 123. Final test result: {'recall': array([0.06083789, 0.09763795, 0.14871711]), 'ndcg': array([0.06097637, 0.07396714, 0.09075922])}.
