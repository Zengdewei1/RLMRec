2024-06-24 15:41:15,004 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'gccf_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.2}, 'steam': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.01, 'kd_temperature': 0.5}}}
2024-06-24 15:41:30,497 - Epoch   0 Validation set [recall@5: 0.0159 recall@10: 0.0273 recall@20: 0.0444 ] [ndcg@5: 0.0172 ndcg@10: 0.0208 ndcg@20: 0.0263 ] 
2024-06-24 15:41:37,565 - Epoch   3 Validation set [recall@5: 0.0213 recall@10: 0.0374 recall@20: 0.0626 ] [ndcg@5: 0.0214 ndcg@10: 0.0272 ndcg@20: 0.0356 ] 
2024-06-24 15:41:44,253 - Epoch   6 Validation set [recall@5: 0.0233 recall@10: 0.0396 recall@20: 0.0649 ] [ndcg@5: 0.0236 ndcg@10: 0.0293 ndcg@20: 0.0376 ] 
2024-06-24 15:41:51,065 - Epoch   9 Validation set [recall@5: 0.0288 recall@10: 0.0463 recall@20: 0.0743 ] [ndcg@5: 0.0294 ndcg@10: 0.0353 ndcg@20: 0.0444 ] 
2024-06-24 15:41:57,981 - Epoch  12 Validation set [recall@5: 0.0319 recall@10: 0.0516 recall@20: 0.0807 ] [ndcg@5: 0.0321 ndcg@10: 0.0388 ndcg@20: 0.0482 ] 
2024-06-24 15:42:04,332 - Epoch  15 Validation set [recall@5: 0.0345 recall@10: 0.0553 recall@20: 0.0868 ] [ndcg@5: 0.0345 ndcg@10: 0.0415 ndcg@20: 0.0517 ] 
2024-06-24 15:42:10,807 - Epoch  18 Validation set [recall@5: 0.0360 recall@10: 0.0583 recall@20: 0.0913 ] [ndcg@5: 0.0358 ndcg@10: 0.0434 ndcg@20: 0.0542 ] 
2024-06-24 15:42:17,636 - Epoch  21 Validation set [recall@5: 0.0377 recall@10: 0.0610 recall@20: 0.0961 ] [ndcg@5: 0.0372 ndcg@10: 0.0452 ndcg@20: 0.0565 ] 
2024-06-24 15:42:24,025 - Epoch  24 Validation set [recall@5: 0.0392 recall@10: 0.0645 recall@20: 0.0989 ] [ndcg@5: 0.0390 ndcg@10: 0.0476 ndcg@20: 0.0588 ] 
2024-06-24 15:42:30,589 - Epoch  27 Validation set [recall@5: 0.0407 recall@10: 0.0661 recall@20: 0.1014 ] [ndcg@5: 0.0399 ndcg@10: 0.0486 ndcg@20: 0.0601 ] 
2024-06-24 15:42:36,884 - Epoch  30 Validation set [recall@5: 0.0418 recall@10: 0.0676 recall@20: 0.1040 ] [ndcg@5: 0.0412 ndcg@10: 0.0501 ndcg@20: 0.0618 ] 
2024-06-24 15:42:43,728 - Epoch  33 Validation set [recall@5: 0.0432 recall@10: 0.0693 recall@20: 0.1051 ] [ndcg@5: 0.0423 ndcg@10: 0.0512 ndcg@20: 0.0629 ] 
2024-06-24 15:42:50,666 - Epoch  36 Validation set [recall@5: 0.0434 recall@10: 0.0699 recall@20: 0.1070 ] [ndcg@5: 0.0431 ndcg@10: 0.0521 ndcg@20: 0.0642 ] 
2024-06-24 15:42:57,362 - Epoch  39 Validation set [recall@5: 0.0447 recall@10: 0.0710 recall@20: 0.1074 ] [ndcg@5: 0.0441 ndcg@10: 0.0531 ndcg@20: 0.0650 ] 
2024-06-24 15:43:04,177 - Epoch  42 Validation set [recall@5: 0.0452 recall@10: 0.0722 recall@20: 0.1095 ] [ndcg@5: 0.0445 ndcg@10: 0.0538 ndcg@20: 0.0661 ] 
2024-06-24 15:43:11,098 - Epoch  45 Validation set [recall@5: 0.0454 recall@10: 0.0727 recall@20: 0.1115 ] [ndcg@5: 0.0449 ndcg@10: 0.0545 ndcg@20: 0.0670 ] 
2024-06-24 15:43:17,771 - Epoch  48 Validation set [recall@5: 0.0453 recall@10: 0.0733 recall@20: 0.1122 ] [ndcg@5: 0.0452 ndcg@10: 0.0549 ndcg@20: 0.0675 ] 
2024-06-24 15:43:24,915 - Epoch  51 Validation set [recall@5: 0.0465 recall@10: 0.0744 recall@20: 0.1139 ] [ndcg@5: 0.0458 ndcg@10: 0.0555 ndcg@20: 0.0683 ] 
2024-06-24 15:43:31,177 - Epoch  54 Validation set [recall@5: 0.0466 recall@10: 0.0752 recall@20: 0.1149 ] [ndcg@5: 0.0460 ndcg@10: 0.0559 ndcg@20: 0.0687 ] 
2024-06-24 15:43:37,264 - Epoch  57 Validation set [recall@5: 0.0471 recall@10: 0.0758 recall@20: 0.1164 ] [ndcg@5: 0.0464 ndcg@10: 0.0564 ndcg@20: 0.0695 ] 
2024-06-24 15:43:44,160 - Epoch  60 Validation set [recall@5: 0.0479 recall@10: 0.0773 recall@20: 0.1168 ] [ndcg@5: 0.0471 ndcg@10: 0.0572 ndcg@20: 0.0701 ] 
2024-06-24 15:43:50,699 - Epoch  63 Validation set [recall@5: 0.0485 recall@10: 0.0774 recall@20: 0.1168 ] [ndcg@5: 0.0479 ndcg@10: 0.0580 ndcg@20: 0.0708 ] 
2024-06-24 15:43:57,858 - Epoch  66 Validation set [recall@5: 0.0494 recall@10: 0.0783 recall@20: 0.1187 ] [ndcg@5: 0.0484 ndcg@10: 0.0583 ndcg@20: 0.0714 ] 
2024-06-24 15:44:04,712 - Epoch  69 Validation set [recall@5: 0.0497 recall@10: 0.0788 recall@20: 0.1201 ] [ndcg@5: 0.0488 ndcg@10: 0.0588 ndcg@20: 0.0722 ] 
2024-06-24 15:44:11,665 - Epoch  72 Validation set [recall@5: 0.0500 recall@10: 0.0799 recall@20: 0.1207 ] [ndcg@5: 0.0491 ndcg@10: 0.0594 ndcg@20: 0.0727 ] 
2024-06-24 15:44:18,777 - Epoch  75 Validation set [recall@5: 0.0512 recall@10: 0.0794 recall@20: 0.1217 ] [ndcg@5: 0.0497 ndcg@10: 0.0593 ndcg@20: 0.0732 ] 
2024-06-24 15:44:25,892 - Epoch  78 Validation set [recall@5: 0.0505 recall@10: 0.0798 recall@20: 0.1232 ] [ndcg@5: 0.0495 ndcg@10: 0.0595 ndcg@20: 0.0737 ] 
2024-06-24 15:44:32,939 - Epoch  81 Validation set [recall@5: 0.0505 recall@10: 0.0805 recall@20: 0.1234 ] [ndcg@5: 0.0497 ndcg@10: 0.0601 ndcg@20: 0.0741 ] 
2024-06-24 15:44:39,315 - Epoch  84 Validation set [recall@5: 0.0512 recall@10: 0.0809 recall@20: 0.1243 ] [ndcg@5: 0.0501 ndcg@10: 0.0603 ndcg@20: 0.0744 ] 
2024-06-24 15:44:46,015 - Epoch  87 Validation set [recall@5: 0.0508 recall@10: 0.0809 recall@20: 0.1252 ] [ndcg@5: 0.0501 ndcg@10: 0.0606 ndcg@20: 0.0749 ] 
2024-06-24 15:44:53,817 - Epoch  90 Validation set [recall@5: 0.0512 recall@10: 0.0818 recall@20: 0.1253 ] [ndcg@5: 0.0503 ndcg@10: 0.0609 ndcg@20: 0.0750 ] 
2024-06-24 15:45:00,395 - Epoch  93 Validation set [recall@5: 0.0518 recall@10: 0.0832 recall@20: 0.1256 ] [ndcg@5: 0.0506 ndcg@10: 0.0614 ndcg@20: 0.0753 ] 
2024-06-24 15:45:06,957 - Epoch  96 Validation set [recall@5: 0.0516 recall@10: 0.0835 recall@20: 0.1267 ] [ndcg@5: 0.0505 ndcg@10: 0.0614 ndcg@20: 0.0756 ] 
2024-06-24 15:45:13,661 - Epoch  99 Validation set [recall@5: 0.0516 recall@10: 0.0844 recall@20: 0.1273 ] [ndcg@5: 0.0505 ndcg@10: 0.0619 ndcg@20: 0.0760 ] 
2024-06-24 15:45:20,317 - Epoch 102 Validation set [recall@5: 0.0518 recall@10: 0.0838 recall@20: 0.1277 ] [ndcg@5: 0.0506 ndcg@10: 0.0618 ndcg@20: 0.0761 ] 
2024-06-24 15:45:26,740 - Epoch 105 Validation set [recall@5: 0.0517 recall@10: 0.0845 recall@20: 0.1280 ] [ndcg@5: 0.0508 ndcg@10: 0.0624 ndcg@20: 0.0765 ] 
2024-06-24 15:45:33,511 - Epoch 108 Validation set [recall@5: 0.0517 recall@10: 0.0838 recall@20: 0.1287 ] [ndcg@5: 0.0511 ndcg@10: 0.0625 ndcg@20: 0.0771 ] 
2024-06-24 15:45:39,996 - Epoch 111 Validation set [recall@5: 0.0529 recall@10: 0.0842 recall@20: 0.1291 ] [ndcg@5: 0.0518 ndcg@10: 0.0627 ndcg@20: 0.0773 ] 
2024-06-24 15:45:46,787 - Epoch 114 Validation set [recall@5: 0.0533 recall@10: 0.0843 recall@20: 0.1299 ] [ndcg@5: 0.0522 ndcg@10: 0.0630 ndcg@20: 0.0779 ] 
2024-06-24 15:45:53,692 - Epoch 117 Validation set [recall@5: 0.0533 recall@10: 0.0849 recall@20: 0.1304 ] [ndcg@5: 0.0525 ndcg@10: 0.0634 ndcg@20: 0.0783 ] 
2024-06-24 15:46:00,744 - Epoch 120 Validation set [recall@5: 0.0544 recall@10: 0.0855 recall@20: 0.1312 ] [ndcg@5: 0.0529 ndcg@10: 0.0636 ndcg@20: 0.0785 ] 
2024-06-24 15:46:07,421 - Epoch 123 Validation set [recall@5: 0.0542 recall@10: 0.0850 recall@20: 0.1322 ] [ndcg@5: 0.0531 ndcg@10: 0.0637 ndcg@20: 0.0790 ] 
2024-06-24 15:46:14,087 - Epoch 126 Validation set [recall@5: 0.0546 recall@10: 0.0852 recall@20: 0.1321 ] [ndcg@5: 0.0532 ndcg@10: 0.0639 ndcg@20: 0.0790 ] 
2024-06-24 15:46:20,409 - Epoch 129 Validation set [recall@5: 0.0543 recall@10: 0.0867 recall@20: 0.1321 ] [ndcg@5: 0.0533 ndcg@10: 0.0644 ndcg@20: 0.0792 ] 
2024-06-24 15:46:26,646 - Epoch 132 Validation set [recall@5: 0.0536 recall@10: 0.0862 recall@20: 0.1320 ] [ndcg@5: 0.0533 ndcg@10: 0.0645 ndcg@20: 0.0794 ] 
2024-06-24 15:46:34,426 - Epoch 135 Validation set [recall@5: 0.0539 recall@10: 0.0864 recall@20: 0.1327 ] [ndcg@5: 0.0536 ndcg@10: 0.0646 ndcg@20: 0.0796 ] 
2024-06-24 15:46:41,048 - Epoch 138 Validation set [recall@5: 0.0543 recall@10: 0.0870 recall@20: 0.1320 ] [ndcg@5: 0.0537 ndcg@10: 0.0649 ndcg@20: 0.0796 ] 
2024-06-24 15:46:48,588 - Epoch 141 Validation set [recall@5: 0.0541 recall@10: 0.0872 recall@20: 0.1326 ] [ndcg@5: 0.0538 ndcg@10: 0.0651 ndcg@20: 0.0799 ] 
2024-06-24 15:46:56,236 - Epoch 144 Validation set [recall@5: 0.0549 recall@10: 0.0872 recall@20: 0.1328 ] [ndcg@5: 0.0543 ndcg@10: 0.0652 ndcg@20: 0.0801 ] 
2024-06-24 15:47:03,943 - Epoch 147 Validation set [recall@5: 0.0548 recall@10: 0.0862 recall@20: 0.1338 ] [ndcg@5: 0.0544 ndcg@10: 0.0653 ndcg@20: 0.0806 ] 
2024-06-24 15:47:11,228 - Epoch 150 Validation set [recall@5: 0.0553 recall@10: 0.0865 recall@20: 0.1341 ] [ndcg@5: 0.0547 ndcg@10: 0.0654 ndcg@20: 0.0809 ] 
2024-06-24 15:47:17,914 - Epoch 153 Validation set [recall@5: 0.0541 recall@10: 0.0871 recall@20: 0.1347 ] [ndcg@5: 0.0542 ndcg@10: 0.0657 ndcg@20: 0.0811 ] 
2024-06-24 15:47:24,921 - Epoch 156 Validation set [recall@5: 0.0545 recall@10: 0.0880 recall@20: 0.1347 ] [ndcg@5: 0.0545 ndcg@10: 0.0660 ndcg@20: 0.0811 ] 
2024-06-24 15:47:31,825 - Epoch 159 Validation set [recall@5: 0.0556 recall@10: 0.0883 recall@20: 0.1354 ] [ndcg@5: 0.0552 ndcg@10: 0.0663 ndcg@20: 0.0816 ] 
2024-06-24 15:47:38,737 - Epoch 162 Validation set [recall@5: 0.0552 recall@10: 0.0877 recall@20: 0.1359 ] [ndcg@5: 0.0548 ndcg@10: 0.0660 ndcg@20: 0.0816 ] 
2024-06-24 15:47:45,386 - Epoch 165 Validation set [recall@5: 0.0553 recall@10: 0.0881 recall@20: 0.1355 ] [ndcg@5: 0.0552 ndcg@10: 0.0664 ndcg@20: 0.0818 ] 
2024-06-24 15:47:53,299 - Epoch 168 Validation set [recall@5: 0.0556 recall@10: 0.0876 recall@20: 0.1372 ] [ndcg@5: 0.0553 ndcg@10: 0.0663 ndcg@20: 0.0824 ] 
2024-06-24 15:47:59,822 - Epoch 171 Validation set [recall@5: 0.0554 recall@10: 0.0878 recall@20: 0.1370 ] [ndcg@5: 0.0556 ndcg@10: 0.0666 ndcg@20: 0.0826 ] 
2024-06-24 15:48:06,156 - Epoch 174 Validation set [recall@5: 0.0547 recall@10: 0.0883 recall@20: 0.1373 ] [ndcg@5: 0.0552 ndcg@10: 0.0667 ndcg@20: 0.0826 ] 
2024-06-24 15:48:12,465 - Epoch 177 Validation set [recall@5: 0.0548 recall@10: 0.0887 recall@20: 0.1385 ] [ndcg@5: 0.0552 ndcg@10: 0.0669 ndcg@20: 0.0831 ] 
2024-06-24 15:48:19,131 - Epoch 180 Validation set [recall@5: 0.0553 recall@10: 0.0887 recall@20: 0.1389 ] [ndcg@5: 0.0552 ndcg@10: 0.0665 ndcg@20: 0.0827 ] 
2024-06-24 15:48:25,412 - Epoch 183 Validation set [recall@5: 0.0557 recall@10: 0.0883 recall@20: 0.1393 ] [ndcg@5: 0.0554 ndcg@10: 0.0665 ndcg@20: 0.0831 ] 
2024-06-24 15:48:31,926 - Epoch 186 Validation set [recall@5: 0.0557 recall@10: 0.0883 recall@20: 0.1387 ] [ndcg@5: 0.0554 ndcg@10: 0.0667 ndcg@20: 0.0831 ] 
2024-06-24 15:48:38,820 - Epoch 189 Validation set [recall@5: 0.0557 recall@10: 0.0885 recall@20: 0.1389 ] [ndcg@5: 0.0553 ndcg@10: 0.0667 ndcg@20: 0.0830 ] 
2024-06-24 15:48:45,099 - Epoch 192 Validation set [recall@5: 0.0563 recall@10: 0.0884 recall@20: 0.1394 ] [ndcg@5: 0.0555 ndcg@10: 0.0667 ndcg@20: 0.0831 ] 
2024-06-24 15:48:52,198 - Epoch 195 Validation set [recall@5: 0.0561 recall@10: 0.0883 recall@20: 0.1390 ] [ndcg@5: 0.0554 ndcg@10: 0.0667 ndcg@20: 0.0830 ] 
2024-06-24 15:48:59,644 - Epoch 198 Validation set [recall@5: 0.0558 recall@10: 0.0883 recall@20: 0.1384 ] [ndcg@5: 0.0552 ndcg@10: 0.0666 ndcg@20: 0.0827 ] 
2024-06-24 15:49:06,287 - Epoch 201 Validation set [recall@5: 0.0550 recall@10: 0.0890 recall@20: 0.1392 ] [ndcg@5: 0.0551 ndcg@10: 0.0671 ndcg@20: 0.0833 ] 
2024-06-24 15:49:12,920 - Epoch 204 Validation set [recall@5: 0.0557 recall@10: 0.0889 recall@20: 0.1397 ] [ndcg@5: 0.0554 ndcg@10: 0.0670 ndcg@20: 0.0834 ] 
2024-06-24 15:49:19,402 - Epoch 207 Validation set [recall@5: 0.0555 recall@10: 0.0896 recall@20: 0.1396 ] [ndcg@5: 0.0556 ndcg@10: 0.0677 ndcg@20: 0.0838 ] 
2024-06-24 15:49:27,019 - Epoch 210 Validation set [recall@5: 0.0560 recall@10: 0.0905 recall@20: 0.1396 ] [ndcg@5: 0.0557 ndcg@10: 0.0680 ndcg@20: 0.0838 ] 
2024-06-24 15:49:34,093 - Epoch 213 Validation set [recall@5: 0.0560 recall@10: 0.0903 recall@20: 0.1401 ] [ndcg@5: 0.0559 ndcg@10: 0.0680 ndcg@20: 0.0838 ] 
2024-06-24 15:49:40,273 - Epoch 216 Validation set [recall@5: 0.0570 recall@10: 0.0909 recall@20: 0.1410 ] [ndcg@5: 0.0564 ndcg@10: 0.0682 ndcg@20: 0.0842 ] 
2024-06-24 15:49:46,516 - Epoch 219 Validation set [recall@5: 0.0568 recall@10: 0.0900 recall@20: 0.1405 ] [ndcg@5: 0.0562 ndcg@10: 0.0679 ndcg@20: 0.0841 ] 
2024-06-24 15:49:53,334 - Epoch 222 Validation set [recall@5: 0.0569 recall@10: 0.0904 recall@20: 0.1404 ] [ndcg@5: 0.0566 ndcg@10: 0.0682 ndcg@20: 0.0843 ] 
2024-06-24 15:50:01,927 - Epoch 225 Validation set [recall@5: 0.0572 recall@10: 0.0901 recall@20: 0.1415 ] [ndcg@5: 0.0568 ndcg@10: 0.0682 ndcg@20: 0.0847 ] 
2024-06-24 15:50:08,854 - Epoch 228 Validation set [recall@5: 0.0567 recall@10: 0.0899 recall@20: 0.1412 ] [ndcg@5: 0.0563 ndcg@10: 0.0680 ndcg@20: 0.0844 ] 
2024-06-24 15:50:15,567 - Epoch 231 Validation set [recall@5: 0.0561 recall@10: 0.0897 recall@20: 0.1406 ] [ndcg@5: 0.0561 ndcg@10: 0.0679 ndcg@20: 0.0843 ] 
2024-06-24 15:50:22,307 - Epoch 234 Validation set [recall@5: 0.0555 recall@10: 0.0898 recall@20: 0.1405 ] [ndcg@5: 0.0558 ndcg@10: 0.0677 ndcg@20: 0.0841 ] 
2024-06-24 15:50:28,876 - Epoch 237 Validation set [recall@5: 0.0561 recall@10: 0.0903 recall@20: 0.1406 ] [ndcg@5: 0.0559 ndcg@10: 0.0679 ndcg@20: 0.0841 ] 
2024-06-24 15:50:36,390 - Epoch 240 Validation set [recall@5: 0.0574 recall@10: 0.0901 recall@20: 0.1412 ] [ndcg@5: 0.0566 ndcg@10: 0.0680 ndcg@20: 0.0844 ] 
2024-06-24 15:50:38,622 - [recall@5: 0.0572 recall@10: 0.0901 recall@20: 0.1415 ] [ndcg@5: 0.0568 ndcg@10: 0.0682 ndcg@20: 0.0847 ] 
2024-06-24 15:50:40,947 - [recall@5: 0.0546 recall@10: 0.0896 recall@20: 0.1387 ] [ndcg@5: 0.0542 ndcg@10: 0.0665 ndcg@20: 0.0828 ] 
2024-06-24 15:50:40,992 - Save model parameters to ./encoder/checkpoint/gccf_plus/gccf_plus-amazon-2023.pth
2024-06-24 15:50:40,993 - Best Epoch 225. Final test result: {'recall': array([0.05456861, 0.08962121, 0.13867389]), 'ndcg': array([0.05421468, 0.06652177, 0.08276555])}.
