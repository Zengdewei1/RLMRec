2024-06-22 16:41:03,657 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'gccf_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.2}, 'steam': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.01, 'kd_temperature': 0.5}}}
2024-06-22 16:41:16,171 - Epoch   0 Validation set [recall@5: 0.0011 recall@10: 0.0020 recall@20: 0.0039 ] [ndcg@5: 0.0009 ndcg@10: 0.0013 ndcg@20: 0.0019 ] 
2024-06-22 16:41:21,145 - Epoch   3 Validation set [recall@5: 0.0083 recall@10: 0.0142 recall@20: 0.0221 ] [ndcg@5: 0.0087 ndcg@10: 0.0106 ndcg@20: 0.0133 ] 
2024-06-22 16:41:26,189 - Epoch   6 Validation set [recall@5: 0.0133 recall@10: 0.0237 recall@20: 0.0423 ] [ndcg@5: 0.0135 ndcg@10: 0.0172 ndcg@20: 0.0232 ] 
2024-06-22 16:41:30,773 - Epoch   9 Validation set [recall@5: 0.0150 recall@10: 0.0262 recall@20: 0.0460 ] [ndcg@5: 0.0153 ndcg@10: 0.0194 ndcg@20: 0.0259 ] 
2024-06-22 16:41:35,444 - Epoch  12 Validation set [recall@5: 0.0189 recall@10: 0.0313 recall@20: 0.0527 ] [ndcg@5: 0.0196 ndcg@10: 0.0239 ndcg@20: 0.0309 ] 
2024-06-22 16:41:40,077 - Epoch  15 Validation set [recall@5: 0.0226 recall@10: 0.0372 recall@20: 0.0605 ] [ndcg@5: 0.0232 ndcg@10: 0.0282 ndcg@20: 0.0358 ] 
2024-06-22 16:41:45,121 - Epoch  18 Validation set [recall@5: 0.0259 recall@10: 0.0433 recall@20: 0.0696 ] [ndcg@5: 0.0267 ndcg@10: 0.0326 ndcg@20: 0.0410 ] 
2024-06-22 16:41:50,042 - Epoch  21 Validation set [recall@5: 0.0287 recall@10: 0.0463 recall@20: 0.0764 ] [ndcg@5: 0.0295 ndcg@10: 0.0354 ndcg@20: 0.0452 ] 
2024-06-22 16:41:54,431 - Epoch  24 Validation set [recall@5: 0.0306 recall@10: 0.0503 recall@20: 0.0808 ] [ndcg@5: 0.0315 ndcg@10: 0.0383 ndcg@20: 0.0482 ] 
2024-06-22 16:41:58,309 - Epoch  27 Validation set [recall@5: 0.0329 recall@10: 0.0529 recall@20: 0.0848 ] [ndcg@5: 0.0335 ndcg@10: 0.0403 ndcg@20: 0.0506 ] 
2024-06-22 16:42:02,296 - Epoch  30 Validation set [recall@5: 0.0347 recall@10: 0.0555 recall@20: 0.0876 ] [ndcg@5: 0.0351 ndcg@10: 0.0422 ndcg@20: 0.0527 ] 
2024-06-22 16:42:06,438 - Epoch  33 Validation set [recall@5: 0.0355 recall@10: 0.0586 recall@20: 0.0908 ] [ndcg@5: 0.0360 ndcg@10: 0.0440 ndcg@20: 0.0545 ] 
2024-06-22 16:42:10,799 - Epoch  36 Validation set [recall@5: 0.0374 recall@10: 0.0613 recall@20: 0.0939 ] [ndcg@5: 0.0377 ndcg@10: 0.0461 ndcg@20: 0.0567 ] 
2024-06-22 16:42:14,967 - Epoch  39 Validation set [recall@5: 0.0391 recall@10: 0.0634 recall@20: 0.0964 ] [ndcg@5: 0.0392 ndcg@10: 0.0478 ndcg@20: 0.0584 ] 
2024-06-22 16:42:19,049 - Epoch  42 Validation set [recall@5: 0.0402 recall@10: 0.0645 recall@20: 0.0990 ] [ndcg@5: 0.0402 ndcg@10: 0.0488 ndcg@20: 0.0600 ] 
2024-06-22 16:42:23,416 - Epoch  45 Validation set [recall@5: 0.0417 recall@10: 0.0660 recall@20: 0.1016 ] [ndcg@5: 0.0412 ndcg@10: 0.0499 ndcg@20: 0.0615 ] 
2024-06-22 16:42:28,207 - Epoch  48 Validation set [recall@5: 0.0423 recall@10: 0.0672 recall@20: 0.1035 ] [ndcg@5: 0.0419 ndcg@10: 0.0507 ndcg@20: 0.0625 ] 
2024-06-22 16:42:32,287 - Epoch  51 Validation set [recall@5: 0.0430 recall@10: 0.0689 recall@20: 0.1052 ] [ndcg@5: 0.0428 ndcg@10: 0.0519 ndcg@20: 0.0638 ] 
2024-06-22 16:42:36,744 - Epoch  54 Validation set [recall@5: 0.0436 recall@10: 0.0698 recall@20: 0.1058 ] [ndcg@5: 0.0433 ndcg@10: 0.0526 ndcg@20: 0.0644 ] 
2024-06-22 16:42:42,053 - Epoch  57 Validation set [recall@5: 0.0446 recall@10: 0.0708 recall@20: 0.1078 ] [ndcg@5: 0.0440 ndcg@10: 0.0533 ndcg@20: 0.0653 ] 
2024-06-22 16:42:47,182 - Epoch  60 Validation set [recall@5: 0.0448 recall@10: 0.0719 recall@20: 0.1100 ] [ndcg@5: 0.0444 ndcg@10: 0.0538 ndcg@20: 0.0663 ] 
2024-06-22 16:42:52,446 - Epoch  63 Validation set [recall@5: 0.0459 recall@10: 0.0726 recall@20: 0.1108 ] [ndcg@5: 0.0454 ndcg@10: 0.0547 ndcg@20: 0.0672 ] 
2024-06-22 16:42:57,156 - Epoch  66 Validation set [recall@5: 0.0457 recall@10: 0.0732 recall@20: 0.1120 ] [ndcg@5: 0.0457 ndcg@10: 0.0554 ndcg@20: 0.0679 ] 
2024-06-22 16:43:01,599 - Epoch  69 Validation set [recall@5: 0.0464 recall@10: 0.0737 recall@20: 0.1132 ] [ndcg@5: 0.0462 ndcg@10: 0.0558 ndcg@20: 0.0686 ] 
2024-06-22 16:43:05,848 - Epoch  72 Validation set [recall@5: 0.0473 recall@10: 0.0744 recall@20: 0.1145 ] [ndcg@5: 0.0469 ndcg@10: 0.0563 ndcg@20: 0.0693 ] 
2024-06-22 16:43:10,720 - Epoch  75 Validation set [recall@5: 0.0469 recall@10: 0.0751 recall@20: 0.1160 ] [ndcg@5: 0.0469 ndcg@10: 0.0566 ndcg@20: 0.0699 ] 
2024-06-22 16:43:15,729 - Epoch  78 Validation set [recall@5: 0.0473 recall@10: 0.0756 recall@20: 0.1160 ] [ndcg@5: 0.0473 ndcg@10: 0.0572 ndcg@20: 0.0704 ] 
2024-06-22 16:43:20,372 - Epoch  81 Validation set [recall@5: 0.0476 recall@10: 0.0759 recall@20: 0.1174 ] [ndcg@5: 0.0475 ndcg@10: 0.0575 ndcg@20: 0.0710 ] 
2024-06-22 16:43:24,931 - Epoch  84 Validation set [recall@5: 0.0480 recall@10: 0.0760 recall@20: 0.1188 ] [ndcg@5: 0.0478 ndcg@10: 0.0575 ndcg@20: 0.0714 ] 
2024-06-22 16:43:30,165 - Epoch  87 Validation set [recall@5: 0.0479 recall@10: 0.0773 recall@20: 0.1188 ] [ndcg@5: 0.0480 ndcg@10: 0.0583 ndcg@20: 0.0717 ] 
2024-06-22 16:43:34,798 - Epoch  90 Validation set [recall@5: 0.0481 recall@10: 0.0767 recall@20: 0.1192 ] [ndcg@5: 0.0484 ndcg@10: 0.0583 ndcg@20: 0.0720 ] 
2024-06-22 16:43:38,826 - Epoch  93 Validation set [recall@5: 0.0490 recall@10: 0.0781 recall@20: 0.1208 ] [ndcg@5: 0.0485 ndcg@10: 0.0586 ndcg@20: 0.0724 ] 
2024-06-22 16:43:43,135 - Epoch  96 Validation set [recall@5: 0.0498 recall@10: 0.0777 recall@20: 0.1205 ] [ndcg@5: 0.0491 ndcg@10: 0.0588 ndcg@20: 0.0726 ] 
2024-06-22 16:43:47,255 - Epoch  99 Validation set [recall@5: 0.0508 recall@10: 0.0783 recall@20: 0.1221 ] [ndcg@5: 0.0499 ndcg@10: 0.0592 ndcg@20: 0.0734 ] 
2024-06-22 16:43:52,490 - Epoch 102 Validation set [recall@5: 0.0506 recall@10: 0.0788 recall@20: 0.1230 ] [ndcg@5: 0.0499 ndcg@10: 0.0596 ndcg@20: 0.0740 ] 
2024-06-22 16:43:56,852 - Epoch 105 Validation set [recall@5: 0.0500 recall@10: 0.0793 recall@20: 0.1229 ] [ndcg@5: 0.0499 ndcg@10: 0.0600 ndcg@20: 0.0741 ] 
2024-06-22 16:44:01,627 - Epoch 108 Validation set [recall@5: 0.0502 recall@10: 0.0790 recall@20: 0.1233 ] [ndcg@5: 0.0498 ndcg@10: 0.0598 ndcg@20: 0.0741 ] 
2024-06-22 16:44:06,325 - Epoch 111 Validation set [recall@5: 0.0508 recall@10: 0.0795 recall@20: 0.1227 ] [ndcg@5: 0.0504 ndcg@10: 0.0603 ndcg@20: 0.0744 ] 
2024-06-22 16:44:10,642 - Epoch 114 Validation set [recall@5: 0.0512 recall@10: 0.0797 recall@20: 0.1237 ] [ndcg@5: 0.0508 ndcg@10: 0.0606 ndcg@20: 0.0748 ] 
2024-06-22 16:44:15,705 - Epoch 117 Validation set [recall@5: 0.0512 recall@10: 0.0794 recall@20: 0.1240 ] [ndcg@5: 0.0508 ndcg@10: 0.0606 ndcg@20: 0.0750 ] 
2024-06-22 16:44:20,897 - Epoch 120 Validation set [recall@5: 0.0512 recall@10: 0.0797 recall@20: 0.1251 ] [ndcg@5: 0.0508 ndcg@10: 0.0607 ndcg@20: 0.0754 ] 
2024-06-22 16:44:25,214 - Epoch 123 Validation set [recall@5: 0.0521 recall@10: 0.0801 recall@20: 0.1263 ] [ndcg@5: 0.0513 ndcg@10: 0.0609 ndcg@20: 0.0758 ] 
2024-06-22 16:44:29,828 - Epoch 126 Validation set [recall@5: 0.0522 recall@10: 0.0801 recall@20: 0.1260 ] [ndcg@5: 0.0514 ndcg@10: 0.0611 ndcg@20: 0.0758 ] 
2024-06-22 16:44:35,577 - Epoch 129 Validation set [recall@5: 0.0521 recall@10: 0.0810 recall@20: 0.1262 ] [ndcg@5: 0.0514 ndcg@10: 0.0614 ndcg@20: 0.0760 ] 
2024-06-22 16:44:41,147 - Epoch 132 Validation set [recall@5: 0.0521 recall@10: 0.0809 recall@20: 0.1270 ] [ndcg@5: 0.0516 ndcg@10: 0.0615 ndcg@20: 0.0763 ] 
2024-06-22 16:44:46,865 - Epoch 135 Validation set [recall@5: 0.0518 recall@10: 0.0813 recall@20: 0.1261 ] [ndcg@5: 0.0516 ndcg@10: 0.0617 ndcg@20: 0.0763 ] 
2024-06-22 16:44:52,699 - Epoch 138 Validation set [recall@5: 0.0517 recall@10: 0.0814 recall@20: 0.1263 ] [ndcg@5: 0.0517 ndcg@10: 0.0618 ndcg@20: 0.0764 ] 
2024-06-22 16:44:57,786 - Epoch 141 Validation set [recall@5: 0.0518 recall@10: 0.0813 recall@20: 0.1267 ] [ndcg@5: 0.0519 ndcg@10: 0.0620 ndcg@20: 0.0767 ] 
2024-06-22 16:45:03,938 - Epoch 144 Validation set [recall@5: 0.0523 recall@10: 0.0819 recall@20: 0.1273 ] [ndcg@5: 0.0521 ndcg@10: 0.0622 ndcg@20: 0.0769 ] 
2024-06-22 16:45:09,685 - Epoch 147 Validation set [recall@5: 0.0527 recall@10: 0.0817 recall@20: 0.1275 ] [ndcg@5: 0.0521 ndcg@10: 0.0621 ndcg@20: 0.0769 ] 
2024-06-22 16:45:14,969 - Epoch 150 Validation set [recall@5: 0.0522 recall@10: 0.0817 recall@20: 0.1279 ] [ndcg@5: 0.0520 ndcg@10: 0.0624 ndcg@20: 0.0773 ] 
2024-06-22 16:45:20,466 - Epoch 153 Validation set [recall@5: 0.0523 recall@10: 0.0820 recall@20: 0.1278 ] [ndcg@5: 0.0522 ndcg@10: 0.0626 ndcg@20: 0.0774 ] 
2024-06-22 16:45:25,636 - Epoch 156 Validation set [recall@5: 0.0525 recall@10: 0.0821 recall@20: 0.1276 ] [ndcg@5: 0.0526 ndcg@10: 0.0627 ndcg@20: 0.0775 ] 
2024-06-22 16:45:30,062 - Epoch 159 Validation set [recall@5: 0.0524 recall@10: 0.0821 recall@20: 0.1268 ] [ndcg@5: 0.0524 ndcg@10: 0.0626 ndcg@20: 0.0772 ] 
2024-06-22 16:45:34,593 - Epoch 162 Validation set [recall@5: 0.0518 recall@10: 0.0824 recall@20: 0.1277 ] [ndcg@5: 0.0522 ndcg@10: 0.0627 ndcg@20: 0.0775 ] 
2024-06-22 16:45:39,261 - Epoch 165 Validation set [recall@5: 0.0518 recall@10: 0.0824 recall@20: 0.1286 ] [ndcg@5: 0.0521 ndcg@10: 0.0627 ndcg@20: 0.0777 ] 
2024-06-22 16:45:44,066 - Epoch 168 Validation set [recall@5: 0.0525 recall@10: 0.0827 recall@20: 0.1282 ] [ndcg@5: 0.0526 ndcg@10: 0.0630 ndcg@20: 0.0778 ] 
2024-06-22 16:45:48,429 - Epoch 171 Validation set [recall@5: 0.0527 recall@10: 0.0831 recall@20: 0.1289 ] [ndcg@5: 0.0529 ndcg@10: 0.0633 ndcg@20: 0.0782 ] 
2024-06-22 16:45:52,699 - Epoch 174 Validation set [recall@5: 0.0524 recall@10: 0.0826 recall@20: 0.1290 ] [ndcg@5: 0.0525 ndcg@10: 0.0630 ndcg@20: 0.0781 ] 
2024-06-22 16:45:56,755 - Epoch 177 Validation set [recall@5: 0.0531 recall@10: 0.0825 recall@20: 0.1291 ] [ndcg@5: 0.0529 ndcg@10: 0.0629 ndcg@20: 0.0781 ] 
2024-06-22 16:46:01,474 - Epoch 180 Validation set [recall@5: 0.0531 recall@10: 0.0829 recall@20: 0.1293 ] [ndcg@5: 0.0531 ndcg@10: 0.0633 ndcg@20: 0.0784 ] 
2024-06-22 16:46:06,596 - Epoch 183 Validation set [recall@5: 0.0526 recall@10: 0.0835 recall@20: 0.1290 ] [ndcg@5: 0.0528 ndcg@10: 0.0635 ndcg@20: 0.0783 ] 
2024-06-22 16:46:12,031 - Epoch 186 Validation set [recall@5: 0.0532 recall@10: 0.0832 recall@20: 0.1294 ] [ndcg@5: 0.0530 ndcg@10: 0.0634 ndcg@20: 0.0784 ] 
2024-06-22 16:46:17,565 - Epoch 189 Validation set [recall@5: 0.0531 recall@10: 0.0831 recall@20: 0.1296 ] [ndcg@5: 0.0532 ndcg@10: 0.0635 ndcg@20: 0.0787 ] 
2024-06-22 16:46:21,910 - Epoch 192 Validation set [recall@5: 0.0532 recall@10: 0.0837 recall@20: 0.1294 ] [ndcg@5: 0.0533 ndcg@10: 0.0637 ndcg@20: 0.0786 ] 
2024-06-22 16:46:27,062 - Epoch 195 Validation set [recall@5: 0.0528 recall@10: 0.0831 recall@20: 0.1292 ] [ndcg@5: 0.0531 ndcg@10: 0.0635 ndcg@20: 0.0785 ] 
2024-06-22 16:46:31,793 - Epoch 198 Validation set [recall@5: 0.0531 recall@10: 0.0834 recall@20: 0.1297 ] [ndcg@5: 0.0533 ndcg@10: 0.0638 ndcg@20: 0.0788 ] 
2024-06-22 16:46:36,131 - Epoch 201 Validation set [recall@5: 0.0535 recall@10: 0.0838 recall@20: 0.1314 ] [ndcg@5: 0.0535 ndcg@10: 0.0640 ndcg@20: 0.0793 ] 
2024-06-22 16:46:40,429 - Epoch 204 Validation set [recall@5: 0.0534 recall@10: 0.0843 recall@20: 0.1305 ] [ndcg@5: 0.0534 ndcg@10: 0.0640 ndcg@20: 0.0790 ] 
2024-06-22 16:46:45,398 - Epoch 207 Validation set [recall@5: 0.0538 recall@10: 0.0846 recall@20: 0.1310 ] [ndcg@5: 0.0536 ndcg@10: 0.0642 ndcg@20: 0.0792 ] 
2024-06-22 16:46:50,758 - Epoch 210 Validation set [recall@5: 0.0536 recall@10: 0.0845 recall@20: 0.1314 ] [ndcg@5: 0.0535 ndcg@10: 0.0640 ndcg@20: 0.0793 ] 
2024-06-22 16:46:57,105 - Epoch 213 Validation set [recall@5: 0.0544 recall@10: 0.0839 recall@20: 0.1325 ] [ndcg@5: 0.0538 ndcg@10: 0.0639 ndcg@20: 0.0797 ] 
2024-06-22 16:47:03,256 - Epoch 216 Validation set [recall@5: 0.0541 recall@10: 0.0846 recall@20: 0.1330 ] [ndcg@5: 0.0537 ndcg@10: 0.0641 ndcg@20: 0.0799 ] 
2024-06-22 16:47:09,457 - Epoch 219 Validation set [recall@5: 0.0543 recall@10: 0.0840 recall@20: 0.1328 ] [ndcg@5: 0.0538 ndcg@10: 0.0639 ndcg@20: 0.0800 ] 
2024-06-22 16:47:15,733 - Epoch 222 Validation set [recall@5: 0.0532 recall@10: 0.0846 recall@20: 0.1320 ] [ndcg@5: 0.0535 ndcg@10: 0.0641 ndcg@20: 0.0796 ] 
2024-06-22 16:47:21,966 - Epoch 225 Validation set [recall@5: 0.0541 recall@10: 0.0840 recall@20: 0.1324 ] [ndcg@5: 0.0539 ndcg@10: 0.0639 ndcg@20: 0.0798 ] 
2024-06-22 16:47:28,214 - Epoch 228 Validation set [recall@5: 0.0539 recall@10: 0.0841 recall@20: 0.1324 ] [ndcg@5: 0.0539 ndcg@10: 0.0641 ndcg@20: 0.0799 ] 
2024-06-22 16:47:34,352 - Epoch 231 Validation set [recall@5: 0.0536 recall@10: 0.0843 recall@20: 0.1325 ] [ndcg@5: 0.0539 ndcg@10: 0.0642 ndcg@20: 0.0800 ] 
2024-06-22 16:47:36,255 - [recall@5: 0.0541 recall@10: 0.0846 recall@20: 0.1330 ] [ndcg@5: 0.0537 ndcg@10: 0.0641 ndcg@20: 0.0799 ] 
2024-06-22 16:47:37,630 - [recall@5: 0.0529 recall@10: 0.0839 recall@20: 0.1291 ] [ndcg@5: 0.0519 ndcg@10: 0.0627 ndcg@20: 0.0776 ] 
2024-06-22 16:47:37,654 - Save model parameters to ./encoder/checkpoint/gccf_plus/gccf_plus-amazon-2023.pth
2024-06-22 16:47:37,654 - Best Epoch 216. Final test result: {'recall': array([0.05290643, 0.08387674, 0.12911717]), 'ndcg': array([0.05194405, 0.06270855, 0.07761383])}.
