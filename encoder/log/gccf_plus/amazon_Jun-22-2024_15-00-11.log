2024-06-22 15:00:11,240 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'gccf_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.2}, 'steam': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.01, 'kd_temperature': 0.5}}}
2024-06-22 15:00:23,134 - Epoch   0 Validation set [recall@5: 0.0010 recall@10: 0.0014 recall@20: 0.0028 ] [ndcg@5: 0.0010 ndcg@10: 0.0011 ndcg@20: 0.0016 ] 
2024-06-22 15:00:29,879 - Epoch   3 Validation set [recall@5: 0.0066 recall@10: 0.0105 recall@20: 0.0171 ] [ndcg@5: 0.0068 ndcg@10: 0.0081 ndcg@20: 0.0102 ] 
2024-06-22 15:00:35,963 - Epoch   6 Validation set [recall@5: 0.0146 recall@10: 0.0259 recall@20: 0.0444 ] [ndcg@5: 0.0150 ndcg@10: 0.0192 ndcg@20: 0.0252 ] 
2024-06-22 15:00:40,576 - Epoch   9 Validation set [recall@5: 0.0156 recall@10: 0.0282 recall@20: 0.0477 ] [ndcg@5: 0.0163 ndcg@10: 0.0208 ndcg@20: 0.0273 ] 
2024-06-22 15:00:45,443 - Epoch  12 Validation set [recall@5: 0.0180 recall@10: 0.0316 recall@20: 0.0514 ] [ndcg@5: 0.0187 ndcg@10: 0.0235 ndcg@20: 0.0300 ] 
2024-06-22 15:00:49,825 - Epoch  15 Validation set [recall@5: 0.0223 recall@10: 0.0355 recall@20: 0.0576 ] [ndcg@5: 0.0227 ndcg@10: 0.0271 ndcg@20: 0.0343 ] 
2024-06-22 15:00:54,032 - Epoch  18 Validation set [recall@5: 0.0247 recall@10: 0.0407 recall@20: 0.0660 ] [ndcg@5: 0.0254 ndcg@10: 0.0308 ndcg@20: 0.0389 ] 
2024-06-22 15:00:58,819 - Epoch  21 Validation set [recall@5: 0.0278 recall@10: 0.0461 recall@20: 0.0736 ] [ndcg@5: 0.0280 ndcg@10: 0.0343 ndcg@20: 0.0432 ] 
2024-06-22 15:01:03,995 - Epoch  24 Validation set [recall@5: 0.0318 recall@10: 0.0510 recall@20: 0.0797 ] [ndcg@5: 0.0315 ndcg@10: 0.0381 ndcg@20: 0.0474 ] 
2024-06-22 15:01:08,725 - Epoch  27 Validation set [recall@5: 0.0325 recall@10: 0.0547 recall@20: 0.0855 ] [ndcg@5: 0.0331 ndcg@10: 0.0408 ndcg@20: 0.0508 ] 
2024-06-22 15:01:14,142 - Epoch  30 Validation set [recall@5: 0.0351 recall@10: 0.0569 recall@20: 0.0894 ] [ndcg@5: 0.0354 ndcg@10: 0.0428 ndcg@20: 0.0534 ] 
2024-06-22 15:01:19,227 - Epoch  33 Validation set [recall@5: 0.0359 recall@10: 0.0586 recall@20: 0.0919 ] [ndcg@5: 0.0362 ndcg@10: 0.0441 ndcg@20: 0.0549 ] 
2024-06-22 15:01:24,824 - Epoch  36 Validation set [recall@5: 0.0381 recall@10: 0.0608 recall@20: 0.0947 ] [ndcg@5: 0.0381 ndcg@10: 0.0459 ndcg@20: 0.0569 ] 
2024-06-22 15:01:29,759 - Epoch  39 Validation set [recall@5: 0.0397 recall@10: 0.0636 recall@20: 0.0979 ] [ndcg@5: 0.0396 ndcg@10: 0.0477 ndcg@20: 0.0587 ] 
2024-06-22 15:01:33,968 - Epoch  42 Validation set [recall@5: 0.0406 recall@10: 0.0647 recall@20: 0.1000 ] [ndcg@5: 0.0401 ndcg@10: 0.0485 ndcg@20: 0.0599 ] 
2024-06-22 15:01:39,001 - Epoch  45 Validation set [recall@5: 0.0409 recall@10: 0.0660 recall@20: 0.1031 ] [ndcg@5: 0.0409 ndcg@10: 0.0496 ndcg@20: 0.0615 ] 
2024-06-22 15:01:43,638 - Epoch  48 Validation set [recall@5: 0.0417 recall@10: 0.0675 recall@20: 0.1042 ] [ndcg@5: 0.0417 ndcg@10: 0.0506 ndcg@20: 0.0624 ] 
2024-06-22 15:01:48,889 - Epoch  51 Validation set [recall@5: 0.0432 recall@10: 0.0685 recall@20: 0.1054 ] [ndcg@5: 0.0427 ndcg@10: 0.0515 ndcg@20: 0.0634 ] 
2024-06-22 15:01:53,895 - Epoch  54 Validation set [recall@5: 0.0439 recall@10: 0.0688 recall@20: 0.1071 ] [ndcg@5: 0.0435 ndcg@10: 0.0521 ndcg@20: 0.0645 ] 
2024-06-22 15:01:59,370 - Epoch  57 Validation set [recall@5: 0.0441 recall@10: 0.0703 recall@20: 0.1078 ] [ndcg@5: 0.0436 ndcg@10: 0.0527 ndcg@20: 0.0649 ] 
2024-06-22 15:02:04,653 - Epoch  60 Validation set [recall@5: 0.0451 recall@10: 0.0714 recall@20: 0.1098 ] [ndcg@5: 0.0443 ndcg@10: 0.0535 ndcg@20: 0.0659 ] 
2024-06-22 15:02:09,234 - Epoch  63 Validation set [recall@5: 0.0460 recall@10: 0.0716 recall@20: 0.1107 ] [ndcg@5: 0.0454 ndcg@10: 0.0543 ndcg@20: 0.0669 ] 
2024-06-22 15:02:14,572 - Epoch  66 Validation set [recall@5: 0.0457 recall@10: 0.0722 recall@20: 0.1111 ] [ndcg@5: 0.0452 ndcg@10: 0.0545 ndcg@20: 0.0672 ] 
2024-06-22 15:02:19,906 - Epoch  69 Validation set [recall@5: 0.0462 recall@10: 0.0728 recall@20: 0.1125 ] [ndcg@5: 0.0458 ndcg@10: 0.0551 ndcg@20: 0.0680 ] 
2024-06-22 15:02:24,721 - Epoch  72 Validation set [recall@5: 0.0466 recall@10: 0.0734 recall@20: 0.1147 ] [ndcg@5: 0.0462 ndcg@10: 0.0556 ndcg@20: 0.0690 ] 
2024-06-22 15:02:29,083 - Epoch  75 Validation set [recall@5: 0.0470 recall@10: 0.0743 recall@20: 0.1150 ] [ndcg@5: 0.0465 ndcg@10: 0.0561 ndcg@20: 0.0692 ] 
2024-06-22 15:02:33,870 - Epoch  78 Validation set [recall@5: 0.0475 recall@10: 0.0752 recall@20: 0.1156 ] [ndcg@5: 0.0471 ndcg@10: 0.0566 ndcg@20: 0.0697 ] 
2024-06-22 15:02:38,792 - Epoch  81 Validation set [recall@5: 0.0473 recall@10: 0.0758 recall@20: 0.1175 ] [ndcg@5: 0.0471 ndcg@10: 0.0570 ndcg@20: 0.0704 ] 
2024-06-22 15:02:43,787 - Epoch  84 Validation set [recall@5: 0.0474 recall@10: 0.0762 recall@20: 0.1176 ] [ndcg@5: 0.0475 ndcg@10: 0.0575 ndcg@20: 0.0709 ] 
2024-06-22 15:02:48,189 - Epoch  87 Validation set [recall@5: 0.0473 recall@10: 0.0772 recall@20: 0.1193 ] [ndcg@5: 0.0477 ndcg@10: 0.0580 ndcg@20: 0.0717 ] 
2024-06-22 15:02:52,137 - Epoch  90 Validation set [recall@5: 0.0477 recall@10: 0.0782 recall@20: 0.1189 ] [ndcg@5: 0.0479 ndcg@10: 0.0584 ndcg@20: 0.0716 ] 
2024-06-22 15:02:56,783 - Epoch  93 Validation set [recall@5: 0.0485 recall@10: 0.0787 recall@20: 0.1198 ] [ndcg@5: 0.0485 ndcg@10: 0.0588 ndcg@20: 0.0722 ] 
2024-06-22 15:03:00,933 - Epoch  96 Validation set [recall@5: 0.0497 recall@10: 0.0787 recall@20: 0.1199 ] [ndcg@5: 0.0490 ndcg@10: 0.0590 ndcg@20: 0.0725 ] 
2024-06-22 15:03:05,176 - Epoch  99 Validation set [recall@5: 0.0501 recall@10: 0.0787 recall@20: 0.1214 ] [ndcg@5: 0.0495 ndcg@10: 0.0594 ndcg@20: 0.0733 ] 
2024-06-22 15:03:09,272 - Epoch 102 Validation set [recall@5: 0.0504 recall@10: 0.0798 recall@20: 0.1222 ] [ndcg@5: 0.0496 ndcg@10: 0.0597 ndcg@20: 0.0734 ] 
2024-06-22 15:03:13,267 - Epoch 105 Validation set [recall@5: 0.0507 recall@10: 0.0797 recall@20: 0.1224 ] [ndcg@5: 0.0500 ndcg@10: 0.0599 ndcg@20: 0.0738 ] 
2024-06-22 15:03:17,418 - Epoch 108 Validation set [recall@5: 0.0503 recall@10: 0.0798 recall@20: 0.1234 ] [ndcg@5: 0.0499 ndcg@10: 0.0601 ndcg@20: 0.0741 ] 
2024-06-22 15:03:21,431 - Epoch 111 Validation set [recall@5: 0.0519 recall@10: 0.0804 recall@20: 0.1231 ] [ndcg@5: 0.0506 ndcg@10: 0.0603 ndcg@20: 0.0741 ] 
2024-06-22 15:03:26,527 - Epoch 114 Validation set [recall@5: 0.0523 recall@10: 0.0804 recall@20: 0.1236 ] [ndcg@5: 0.0512 ndcg@10: 0.0607 ndcg@20: 0.0747 ] 
2024-06-22 15:03:31,207 - Epoch 117 Validation set [recall@5: 0.0516 recall@10: 0.0809 recall@20: 0.1233 ] [ndcg@5: 0.0510 ndcg@10: 0.0610 ndcg@20: 0.0747 ] 
2024-06-22 15:03:36,112 - Epoch 120 Validation set [recall@5: 0.0525 recall@10: 0.0814 recall@20: 0.1251 ] [ndcg@5: 0.0514 ndcg@10: 0.0613 ndcg@20: 0.0753 ] 
2024-06-22 15:03:40,661 - Epoch 123 Validation set [recall@5: 0.0522 recall@10: 0.0821 recall@20: 0.1250 ] [ndcg@5: 0.0514 ndcg@10: 0.0616 ndcg@20: 0.0754 ] 
2024-06-22 15:03:45,683 - Epoch 126 Validation set [recall@5: 0.0528 recall@10: 0.0829 recall@20: 0.1254 ] [ndcg@5: 0.0518 ndcg@10: 0.0621 ndcg@20: 0.0758 ] 
2024-06-22 15:03:50,303 - Epoch 129 Validation set [recall@5: 0.0524 recall@10: 0.0833 recall@20: 0.1252 ] [ndcg@5: 0.0518 ndcg@10: 0.0624 ndcg@20: 0.0759 ] 
2024-06-22 15:03:54,543 - Epoch 132 Validation set [recall@5: 0.0524 recall@10: 0.0832 recall@20: 0.1247 ] [ndcg@5: 0.0519 ndcg@10: 0.0625 ndcg@20: 0.0759 ] 
2024-06-22 15:03:59,729 - Epoch 135 Validation set [recall@5: 0.0523 recall@10: 0.0843 recall@20: 0.1252 ] [ndcg@5: 0.0520 ndcg@10: 0.0630 ndcg@20: 0.0761 ] 
2024-06-22 15:04:04,336 - Epoch 138 Validation set [recall@5: 0.0529 recall@10: 0.0846 recall@20: 0.1241 ] [ndcg@5: 0.0526 ndcg@10: 0.0634 ndcg@20: 0.0762 ] 
2024-06-22 15:04:08,826 - Epoch 141 Validation set [recall@5: 0.0531 recall@10: 0.0841 recall@20: 0.1259 ] [ndcg@5: 0.0530 ndcg@10: 0.0635 ndcg@20: 0.0769 ] 
2024-06-22 15:04:13,160 - Epoch 144 Validation set [recall@5: 0.0532 recall@10: 0.0839 recall@20: 0.1258 ] [ndcg@5: 0.0530 ndcg@10: 0.0634 ndcg@20: 0.0770 ] 
2024-06-22 15:04:18,352 - Epoch 147 Validation set [recall@5: 0.0542 recall@10: 0.0834 recall@20: 0.1262 ] [ndcg@5: 0.0536 ndcg@10: 0.0634 ndcg@20: 0.0773 ] 
2024-06-22 15:04:22,673 - Epoch 150 Validation set [recall@5: 0.0538 recall@10: 0.0842 recall@20: 0.1264 ] [ndcg@5: 0.0534 ndcg@10: 0.0637 ndcg@20: 0.0774 ] 
2024-06-22 15:04:27,241 - Epoch 153 Validation set [recall@5: 0.0538 recall@10: 0.0848 recall@20: 0.1270 ] [ndcg@5: 0.0534 ndcg@10: 0.0639 ndcg@20: 0.0776 ] 
2024-06-22 15:04:32,448 - Epoch 156 Validation set [recall@5: 0.0542 recall@10: 0.0845 recall@20: 0.1270 ] [ndcg@5: 0.0533 ndcg@10: 0.0636 ndcg@20: 0.0774 ] 
2024-06-22 15:04:38,077 - Epoch 159 Validation set [recall@5: 0.0544 recall@10: 0.0845 recall@20: 0.1280 ] [ndcg@5: 0.0537 ndcg@10: 0.0638 ndcg@20: 0.0780 ] 
2024-06-22 15:04:43,106 - Epoch 162 Validation set [recall@5: 0.0542 recall@10: 0.0860 recall@20: 0.1285 ] [ndcg@5: 0.0536 ndcg@10: 0.0643 ndcg@20: 0.0782 ] 
2024-06-22 15:04:48,128 - Epoch 165 Validation set [recall@5: 0.0539 recall@10: 0.0857 recall@20: 0.1288 ] [ndcg@5: 0.0537 ndcg@10: 0.0645 ndcg@20: 0.0785 ] 
2024-06-22 15:04:53,125 - Epoch 168 Validation set [recall@5: 0.0537 recall@10: 0.0861 recall@20: 0.1290 ] [ndcg@5: 0.0536 ndcg@10: 0.0648 ndcg@20: 0.0787 ] 
2024-06-22 15:04:58,484 - Epoch 171 Validation set [recall@5: 0.0542 recall@10: 0.0865 recall@20: 0.1292 ] [ndcg@5: 0.0540 ndcg@10: 0.0651 ndcg@20: 0.0788 ] 
2024-06-22 15:05:03,647 - Epoch 174 Validation set [recall@5: 0.0542 recall@10: 0.0865 recall@20: 0.1288 ] [ndcg@5: 0.0541 ndcg@10: 0.0650 ndcg@20: 0.0786 ] 
2024-06-22 15:05:08,483 - Epoch 177 Validation set [recall@5: 0.0543 recall@10: 0.0866 recall@20: 0.1294 ] [ndcg@5: 0.0542 ndcg@10: 0.0651 ndcg@20: 0.0789 ] 
2024-06-22 15:05:12,732 - Epoch 180 Validation set [recall@5: 0.0546 recall@10: 0.0866 recall@20: 0.1298 ] [ndcg@5: 0.0543 ndcg@10: 0.0651 ndcg@20: 0.0791 ] 
2024-06-22 15:05:17,667 - Epoch 183 Validation set [recall@5: 0.0546 recall@10: 0.0872 recall@20: 0.1289 ] [ndcg@5: 0.0542 ndcg@10: 0.0652 ndcg@20: 0.0788 ] 
2024-06-22 15:05:22,482 - Epoch 186 Validation set [recall@5: 0.0549 recall@10: 0.0869 recall@20: 0.1289 ] [ndcg@5: 0.0544 ndcg@10: 0.0653 ndcg@20: 0.0790 ] 
2024-06-22 15:05:26,541 - Epoch 189 Validation set [recall@5: 0.0549 recall@10: 0.0865 recall@20: 0.1297 ] [ndcg@5: 0.0545 ndcg@10: 0.0651 ndcg@20: 0.0793 ] 
2024-06-22 15:05:31,212 - Epoch 192 Validation set [recall@5: 0.0550 recall@10: 0.0872 recall@20: 0.1300 ] [ndcg@5: 0.0543 ndcg@10: 0.0652 ndcg@20: 0.0791 ] 
2024-06-22 15:05:35,206 - Epoch 195 Validation set [recall@5: 0.0550 recall@10: 0.0869 recall@20: 0.1301 ] [ndcg@5: 0.0546 ndcg@10: 0.0654 ndcg@20: 0.0795 ] 
2024-06-22 15:05:39,772 - Epoch 198 Validation set [recall@5: 0.0550 recall@10: 0.0863 recall@20: 0.1303 ] [ndcg@5: 0.0548 ndcg@10: 0.0653 ndcg@20: 0.0797 ] 
2024-06-22 15:05:44,055 - Epoch 201 Validation set [recall@5: 0.0551 recall@10: 0.0868 recall@20: 0.1309 ] [ndcg@5: 0.0545 ndcg@10: 0.0653 ndcg@20: 0.0796 ] 
2024-06-22 15:05:48,272 - Epoch 204 Validation set [recall@5: 0.0551 recall@10: 0.0868 recall@20: 0.1304 ] [ndcg@5: 0.0544 ndcg@10: 0.0653 ndcg@20: 0.0795 ] 
2024-06-22 15:05:52,783 - Epoch 207 Validation set [recall@5: 0.0546 recall@10: 0.0872 recall@20: 0.1306 ] [ndcg@5: 0.0546 ndcg@10: 0.0658 ndcg@20: 0.0799 ] 
2024-06-22 15:05:57,310 - Epoch 210 Validation set [recall@5: 0.0552 recall@10: 0.0874 recall@20: 0.1309 ] [ndcg@5: 0.0550 ndcg@10: 0.0660 ndcg@20: 0.0802 ] 
2024-06-22 15:06:01,956 - Epoch 213 Validation set [recall@5: 0.0551 recall@10: 0.0868 recall@20: 0.1311 ] [ndcg@5: 0.0550 ndcg@10: 0.0659 ndcg@20: 0.0804 ] 
2024-06-22 15:06:07,151 - Epoch 216 Validation set [recall@5: 0.0550 recall@10: 0.0866 recall@20: 0.1317 ] [ndcg@5: 0.0549 ndcg@10: 0.0659 ndcg@20: 0.0805 ] 
2024-06-22 15:06:11,401 - Epoch 219 Validation set [recall@5: 0.0552 recall@10: 0.0875 recall@20: 0.1324 ] [ndcg@5: 0.0549 ndcg@10: 0.0661 ndcg@20: 0.0807 ] 
2024-06-22 15:06:15,996 - Epoch 222 Validation set [recall@5: 0.0559 recall@10: 0.0880 recall@20: 0.1322 ] [ndcg@5: 0.0551 ndcg@10: 0.0662 ndcg@20: 0.0806 ] 
2024-06-22 15:06:20,664 - Epoch 225 Validation set [recall@5: 0.0557 recall@10: 0.0875 recall@20: 0.1320 ] [ndcg@5: 0.0550 ndcg@10: 0.0660 ndcg@20: 0.0804 ] 
2024-06-22 15:06:25,135 - Epoch 228 Validation set [recall@5: 0.0560 recall@10: 0.0877 recall@20: 0.1323 ] [ndcg@5: 0.0550 ndcg@10: 0.0660 ndcg@20: 0.0805 ] 
2024-06-22 15:06:29,199 - Epoch 231 Validation set [recall@5: 0.0557 recall@10: 0.0872 recall@20: 0.1321 ] [ndcg@5: 0.0548 ndcg@10: 0.0658 ndcg@20: 0.0805 ] 
2024-06-22 15:06:33,743 - Epoch 234 Validation set [recall@5: 0.0561 recall@10: 0.0879 recall@20: 0.1316 ] [ndcg@5: 0.0550 ndcg@10: 0.0660 ndcg@20: 0.0804 ] 
2024-06-22 15:06:35,167 - [recall@5: 0.0552 recall@10: 0.0875 recall@20: 0.1324 ] [ndcg@5: 0.0549 ndcg@10: 0.0661 ndcg@20: 0.0807 ] 
2024-06-22 15:06:36,468 - [recall@5: 0.0540 recall@10: 0.0870 recall@20: 0.1316 ] [ndcg@5: 0.0532 ndcg@10: 0.0649 ndcg@20: 0.0794 ] 
2024-06-22 15:06:36,518 - Save model parameters to ./encoder/checkpoint/gccf_plus/gccf_plus-amazon-2023.pth
2024-06-22 15:06:36,518 - Best Epoch 219. Final test result: {'recall': array([0.05401756, 0.08696977, 0.13159501]), 'ndcg': array([0.05323661, 0.06490741, 0.07943667])}.
