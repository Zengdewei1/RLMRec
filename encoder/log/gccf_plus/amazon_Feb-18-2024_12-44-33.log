2024-02-18 12:44:33,807 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'gccf_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.001, 'kd_temperature': 0.2}, 'steam': {'layer_num': 2, 'reg_weight': 1e-06, 'kd_weight': 0.01, 'kd_temperature': 0.5}}}
2024-02-18 12:44:38,621 - Epoch   0 Validation set [recall@5: 0.0194 recall@10: 0.0335 recall@20: 0.0547 ] [ndcg@5: 0.0199 ndcg@10: 0.0247 ndcg@20: 0.0315 ] 
2024-02-18 12:44:44,296 - Epoch   3 Validation set [recall@5: 0.0220 recall@10: 0.0379 recall@20: 0.0632 ] [ndcg@5: 0.0228 ndcg@10: 0.0285 ndcg@20: 0.0368 ] 
2024-02-18 12:44:51,254 - Epoch   6 Validation set [recall@5: 0.0250 recall@10: 0.0410 recall@20: 0.0653 ] [ndcg@5: 0.0255 ndcg@10: 0.0309 ndcg@20: 0.0389 ] 
2024-02-18 12:44:57,603 - Epoch   9 Validation set [recall@5: 0.0288 recall@10: 0.0474 recall@20: 0.0732 ] [ndcg@5: 0.0293 ndcg@10: 0.0356 ndcg@20: 0.0439 ] 
2024-02-18 12:45:03,968 - Epoch  12 Validation set [recall@5: 0.0314 recall@10: 0.0517 recall@20: 0.0824 ] [ndcg@5: 0.0317 ndcg@10: 0.0386 ndcg@20: 0.0484 ] 
2024-02-18 12:45:09,966 - Epoch  15 Validation set [recall@5: 0.0331 recall@10: 0.0556 recall@20: 0.0875 ] [ndcg@5: 0.0336 ndcg@10: 0.0413 ndcg@20: 0.0517 ] 
2024-02-18 12:45:16,819 - Epoch  18 Validation set [recall@5: 0.0346 recall@10: 0.0584 recall@20: 0.0915 ] [ndcg@5: 0.0348 ndcg@10: 0.0429 ndcg@20: 0.0538 ] 
2024-02-18 12:45:23,488 - Epoch  21 Validation set [recall@5: 0.0362 recall@10: 0.0600 recall@20: 0.0957 ] [ndcg@5: 0.0359 ndcg@10: 0.0440 ndcg@20: 0.0557 ] 
2024-02-18 12:45:29,485 - Epoch  24 Validation set [recall@5: 0.0382 recall@10: 0.0624 recall@20: 0.0992 ] [ndcg@5: 0.0376 ndcg@10: 0.0459 ndcg@20: 0.0579 ] 
2024-02-18 12:45:35,716 - Epoch  27 Validation set [recall@5: 0.0389 recall@10: 0.0653 recall@20: 0.1015 ] [ndcg@5: 0.0384 ndcg@10: 0.0476 ndcg@20: 0.0593 ] 
2024-02-18 12:45:42,381 - Epoch  30 Validation set [recall@5: 0.0406 recall@10: 0.0668 recall@20: 0.1040 ] [ndcg@5: 0.0402 ndcg@10: 0.0492 ndcg@20: 0.0613 ] 
2024-02-18 12:45:48,605 - Epoch  33 Validation set [recall@5: 0.0418 recall@10: 0.0683 recall@20: 0.1048 ] [ndcg@5: 0.0411 ndcg@10: 0.0504 ndcg@20: 0.0623 ] 
2024-02-18 12:45:55,354 - Epoch  36 Validation set [recall@5: 0.0431 recall@10: 0.0698 recall@20: 0.1070 ] [ndcg@5: 0.0430 ndcg@10: 0.0519 ndcg@20: 0.0642 ] 
2024-02-18 12:46:02,364 - Epoch  39 Validation set [recall@5: 0.0440 recall@10: 0.0706 recall@20: 0.1086 ] [ndcg@5: 0.0437 ndcg@10: 0.0528 ndcg@20: 0.0653 ] 
2024-02-18 12:46:08,976 - Epoch  42 Validation set [recall@5: 0.0450 recall@10: 0.0716 recall@20: 0.1104 ] [ndcg@5: 0.0446 ndcg@10: 0.0537 ndcg@20: 0.0665 ] 
2024-02-18 12:46:15,314 - Epoch  45 Validation set [recall@5: 0.0453 recall@10: 0.0733 recall@20: 0.1120 ] [ndcg@5: 0.0451 ndcg@10: 0.0547 ndcg@20: 0.0673 ] 
2024-02-18 12:46:21,639 - Epoch  48 Validation set [recall@5: 0.0462 recall@10: 0.0736 recall@20: 0.1139 ] [ndcg@5: 0.0456 ndcg@10: 0.0550 ndcg@20: 0.0682 ] 
2024-02-18 12:46:27,545 - Epoch  51 Validation set [recall@5: 0.0466 recall@10: 0.0746 recall@20: 0.1149 ] [ndcg@5: 0.0459 ndcg@10: 0.0557 ndcg@20: 0.0688 ] 
2024-02-18 12:46:33,626 - Epoch  54 Validation set [recall@5: 0.0468 recall@10: 0.0757 recall@20: 0.1161 ] [ndcg@5: 0.0463 ndcg@10: 0.0565 ndcg@20: 0.0697 ] 
2024-02-18 12:46:40,384 - Epoch  57 Validation set [recall@5: 0.0471 recall@10: 0.0763 recall@20: 0.1177 ] [ndcg@5: 0.0466 ndcg@10: 0.0568 ndcg@20: 0.0704 ] 
2024-02-18 12:46:46,814 - Epoch  60 Validation set [recall@5: 0.0482 recall@10: 0.0765 recall@20: 0.1179 ] [ndcg@5: 0.0472 ndcg@10: 0.0572 ndcg@20: 0.0707 ] 
2024-02-18 12:46:53,560 - Epoch  63 Validation set [recall@5: 0.0486 recall@10: 0.0770 recall@20: 0.1191 ] [ndcg@5: 0.0478 ndcg@10: 0.0578 ndcg@20: 0.0715 ] 
2024-02-18 12:47:00,160 - Epoch  66 Validation set [recall@5: 0.0486 recall@10: 0.0778 recall@20: 0.1203 ] [ndcg@5: 0.0480 ndcg@10: 0.0583 ndcg@20: 0.0720 ] 
2024-02-18 12:47:06,190 - Epoch  69 Validation set [recall@5: 0.0488 recall@10: 0.0786 recall@20: 0.1216 ] [ndcg@5: 0.0482 ndcg@10: 0.0588 ndcg@20: 0.0727 ] 
2024-02-18 12:47:12,680 - Epoch  72 Validation set [recall@5: 0.0493 recall@10: 0.0788 recall@20: 0.1227 ] [ndcg@5: 0.0486 ndcg@10: 0.0590 ndcg@20: 0.0733 ] 
2024-02-18 12:47:19,035 - Epoch  75 Validation set [recall@5: 0.0492 recall@10: 0.0797 recall@20: 0.1220 ] [ndcg@5: 0.0487 ndcg@10: 0.0594 ndcg@20: 0.0733 ] 
2024-02-18 12:47:26,236 - Epoch  78 Validation set [recall@5: 0.0497 recall@10: 0.0799 recall@20: 0.1242 ] [ndcg@5: 0.0491 ndcg@10: 0.0597 ndcg@20: 0.0742 ] 
2024-02-18 12:47:32,104 - Epoch  81 Validation set [recall@5: 0.0500 recall@10: 0.0802 recall@20: 0.1253 ] [ndcg@5: 0.0493 ndcg@10: 0.0599 ndcg@20: 0.0746 ] 
2024-02-18 12:47:38,474 - Epoch  84 Validation set [recall@5: 0.0505 recall@10: 0.0810 recall@20: 0.1254 ] [ndcg@5: 0.0498 ndcg@10: 0.0605 ndcg@20: 0.0751 ] 
2024-02-18 12:47:44,842 - Epoch  87 Validation set [recall@5: 0.0504 recall@10: 0.0814 recall@20: 0.1259 ] [ndcg@5: 0.0498 ndcg@10: 0.0609 ndcg@20: 0.0754 ] 
2024-02-18 12:47:51,594 - Epoch  90 Validation set [recall@5: 0.0512 recall@10: 0.0826 recall@20: 0.1269 ] [ndcg@5: 0.0505 ndcg@10: 0.0613 ndcg@20: 0.0758 ] 
2024-02-18 12:47:58,158 - Epoch  93 Validation set [recall@5: 0.0509 recall@10: 0.0838 recall@20: 0.1277 ] [ndcg@5: 0.0505 ndcg@10: 0.0618 ndcg@20: 0.0762 ] 
2024-02-18 12:48:04,491 - Epoch  96 Validation set [recall@5: 0.0516 recall@10: 0.0840 recall@20: 0.1280 ] [ndcg@5: 0.0508 ndcg@10: 0.0619 ndcg@20: 0.0764 ] 
2024-02-18 12:48:11,589 - Epoch  99 Validation set [recall@5: 0.0514 recall@10: 0.0839 recall@20: 0.1289 ] [ndcg@5: 0.0507 ndcg@10: 0.0620 ndcg@20: 0.0767 ] 
2024-02-18 12:48:17,622 - Epoch 102 Validation set [recall@5: 0.0518 recall@10: 0.0843 recall@20: 0.1286 ] [ndcg@5: 0.0509 ndcg@10: 0.0623 ndcg@20: 0.0767 ] 
2024-02-18 12:48:23,798 - Epoch 105 Validation set [recall@5: 0.0519 recall@10: 0.0839 recall@20: 0.1293 ] [ndcg@5: 0.0516 ndcg@10: 0.0626 ndcg@20: 0.0773 ] 
2024-02-18 12:48:29,585 - Epoch 108 Validation set [recall@5: 0.0522 recall@10: 0.0850 recall@20: 0.1300 ] [ndcg@5: 0.0516 ndcg@10: 0.0629 ndcg@20: 0.0775 ] 
2024-02-18 12:48:35,403 - Epoch 111 Validation set [recall@5: 0.0527 recall@10: 0.0852 recall@20: 0.1303 ] [ndcg@5: 0.0522 ndcg@10: 0.0635 ndcg@20: 0.0781 ] 
2024-02-18 12:48:41,630 - Epoch 114 Validation set [recall@5: 0.0531 recall@10: 0.0854 recall@20: 0.1308 ] [ndcg@5: 0.0526 ndcg@10: 0.0637 ndcg@20: 0.0786 ] 
2024-02-18 12:48:48,312 - Epoch 117 Validation set [recall@5: 0.0539 recall@10: 0.0859 recall@20: 0.1314 ] [ndcg@5: 0.0528 ndcg@10: 0.0637 ndcg@20: 0.0787 ] 
2024-02-18 12:48:54,496 - Epoch 120 Validation set [recall@5: 0.0544 recall@10: 0.0867 recall@20: 0.1319 ] [ndcg@5: 0.0533 ndcg@10: 0.0643 ndcg@20: 0.0791 ] 
2024-02-18 12:49:01,046 - Epoch 123 Validation set [recall@5: 0.0545 recall@10: 0.0866 recall@20: 0.1321 ] [ndcg@5: 0.0537 ndcg@10: 0.0647 ndcg@20: 0.0795 ] 
2024-02-18 12:49:07,452 - Epoch 126 Validation set [recall@5: 0.0551 recall@10: 0.0857 recall@20: 0.1323 ] [ndcg@5: 0.0541 ndcg@10: 0.0643 ndcg@20: 0.0796 ] 
2024-02-18 12:49:13,813 - Epoch 129 Validation set [recall@5: 0.0559 recall@10: 0.0865 recall@20: 0.1321 ] [ndcg@5: 0.0547 ndcg@10: 0.0650 ndcg@20: 0.0800 ] 
2024-02-18 12:49:20,688 - Epoch 132 Validation set [recall@5: 0.0550 recall@10: 0.0862 recall@20: 0.1328 ] [ndcg@5: 0.0542 ndcg@10: 0.0648 ndcg@20: 0.0801 ] 
2024-02-18 12:49:27,551 - Epoch 135 Validation set [recall@5: 0.0553 recall@10: 0.0865 recall@20: 0.1329 ] [ndcg@5: 0.0543 ndcg@10: 0.0650 ndcg@20: 0.0801 ] 
2024-02-18 12:49:35,094 - Epoch 138 Validation set [recall@5: 0.0556 recall@10: 0.0867 recall@20: 0.1334 ] [ndcg@5: 0.0546 ndcg@10: 0.0652 ndcg@20: 0.0805 ] 
2024-02-18 12:49:41,281 - Epoch 141 Validation set [recall@5: 0.0565 recall@10: 0.0876 recall@20: 0.1335 ] [ndcg@5: 0.0551 ndcg@10: 0.0655 ndcg@20: 0.0806 ] 
2024-02-18 12:49:48,209 - Epoch 144 Validation set [recall@5: 0.0558 recall@10: 0.0878 recall@20: 0.1341 ] [ndcg@5: 0.0549 ndcg@10: 0.0658 ndcg@20: 0.0810 ] 
2024-02-18 12:49:54,815 - Epoch 147 Validation set [recall@5: 0.0564 recall@10: 0.0882 recall@20: 0.1346 ] [ndcg@5: 0.0553 ndcg@10: 0.0661 ndcg@20: 0.0812 ] 
2024-02-18 12:50:01,416 - Epoch 150 Validation set [recall@5: 0.0563 recall@10: 0.0887 recall@20: 0.1356 ] [ndcg@5: 0.0554 ndcg@10: 0.0663 ndcg@20: 0.0816 ] 
2024-02-18 12:50:07,229 - Epoch 153 Validation set [recall@5: 0.0554 recall@10: 0.0878 recall@20: 0.1355 ] [ndcg@5: 0.0547 ndcg@10: 0.0659 ndcg@20: 0.0815 ] 
2024-02-18 12:50:13,905 - Epoch 156 Validation set [recall@5: 0.0560 recall@10: 0.0878 recall@20: 0.1366 ] [ndcg@5: 0.0552 ndcg@10: 0.0661 ndcg@20: 0.0820 ] 
2024-02-18 12:50:20,387 - Epoch 159 Validation set [recall@5: 0.0566 recall@10: 0.0888 recall@20: 0.1370 ] [ndcg@5: 0.0559 ndcg@10: 0.0668 ndcg@20: 0.0825 ] 
2024-02-18 12:50:27,049 - Epoch 162 Validation set [recall@5: 0.0567 recall@10: 0.0885 recall@20: 0.1372 ] [ndcg@5: 0.0558 ndcg@10: 0.0666 ndcg@20: 0.0824 ] 
2024-02-18 12:50:34,088 - Epoch 165 Validation set [recall@5: 0.0569 recall@10: 0.0891 recall@20: 0.1376 ] [ndcg@5: 0.0560 ndcg@10: 0.0671 ndcg@20: 0.0828 ] 
2024-02-18 12:50:40,574 - Epoch 168 Validation set [recall@5: 0.0572 recall@10: 0.0893 recall@20: 0.1381 ] [ndcg@5: 0.0564 ndcg@10: 0.0673 ndcg@20: 0.0832 ] 
2024-02-18 12:50:46,919 - Epoch 171 Validation set [recall@5: 0.0572 recall@10: 0.0897 recall@20: 0.1396 ] [ndcg@5: 0.0566 ndcg@10: 0.0676 ndcg@20: 0.0837 ] 
2024-02-18 12:50:53,215 - Epoch 174 Validation set [recall@5: 0.0570 recall@10: 0.0889 recall@20: 0.1403 ] [ndcg@5: 0.0568 ndcg@10: 0.0675 ndcg@20: 0.0841 ] 
2024-02-18 12:50:59,115 - Epoch 177 Validation set [recall@5: 0.0563 recall@10: 0.0898 recall@20: 0.1410 ] [ndcg@5: 0.0564 ndcg@10: 0.0677 ndcg@20: 0.0842 ] 
2024-02-18 12:51:05,436 - Epoch 180 Validation set [recall@5: 0.0560 recall@10: 0.0890 recall@20: 0.1410 ] [ndcg@5: 0.0562 ndcg@10: 0.0675 ndcg@20: 0.0843 ] 
2024-02-18 12:51:12,733 - Epoch 183 Validation set [recall@5: 0.0568 recall@10: 0.0894 recall@20: 0.1406 ] [ndcg@5: 0.0566 ndcg@10: 0.0677 ndcg@20: 0.0844 ] 
2024-02-18 12:51:18,427 - Epoch 186 Validation set [recall@5: 0.0578 recall@10: 0.0903 recall@20: 0.1418 ] [ndcg@5: 0.0572 ndcg@10: 0.0682 ndcg@20: 0.0849 ] 
2024-02-18 12:51:24,844 - Epoch 189 Validation set [recall@5: 0.0575 recall@10: 0.0911 recall@20: 0.1412 ] [ndcg@5: 0.0571 ndcg@10: 0.0685 ndcg@20: 0.0848 ] 
2024-02-18 12:51:31,363 - Epoch 192 Validation set [recall@5: 0.0579 recall@10: 0.0900 recall@20: 0.1417 ] [ndcg@5: 0.0578 ndcg@10: 0.0685 ndcg@20: 0.0852 ] 
2024-02-18 12:51:37,792 - Epoch 195 Validation set [recall@5: 0.0576 recall@10: 0.0898 recall@20: 0.1416 ] [ndcg@5: 0.0574 ndcg@10: 0.0683 ndcg@20: 0.0850 ] 
2024-02-18 12:51:44,838 - Epoch 198 Validation set [recall@5: 0.0580 recall@10: 0.0905 recall@20: 0.1415 ] [ndcg@5: 0.0578 ndcg@10: 0.0687 ndcg@20: 0.0851 ] 
2024-02-18 12:51:51,306 - Epoch 201 Validation set [recall@5: 0.0579 recall@10: 0.0909 recall@20: 0.1417 ] [ndcg@5: 0.0577 ndcg@10: 0.0688 ndcg@20: 0.0852 ] 
2024-02-18 12:51:53,526 - [recall@5: 0.0578 recall@10: 0.0903 recall@20: 0.1418 ] [ndcg@5: 0.0572 ndcg@10: 0.0682 ndcg@20: 0.0849 ] 
2024-02-18 12:51:55,389 - [recall@5: 0.0546 recall@10: 0.0890 recall@20: 0.1376 ] [ndcg@5: 0.0542 ndcg@10: 0.0663 ndcg@20: 0.0821 ] 
2024-02-18 12:51:55,442 - Save model parameters to ./encoder/checkpoint/gccf_plus/gccf_plus-amazon-2023.pth
2024-02-18 12:51:55,443 - Best Epoch 186. Final test result: {'recall': array([0.05462341, 0.08899795, 0.13759002]), 'ndcg': array([0.0542084 , 0.06627404, 0.08212184])}.
